{"version":3,"sources":["hooks.tsx","components/UI/Section.tsx","static/appConfig.ts","static/canvasConfig.ts","static/theme.ts","components/SampleTray/NewSampleTray/CanvasItems/BasicSamplePath.tsx","components/SampleTray/NewSampleTray/CanvasItems/CollectionContainer.tsx","components/SampleTray/NewSampleTray/DialogBox.tsx","classes/Kosima.ts","utils.ts","components/SampleTray/NewSampleTray/CanvasItems/Layers/KosimaRender.tsx","classes/SampleCollection.ts","components/SampleTray/NewSampleTray/CanvasItems/CollectionNav.tsx","classes/Tag.ts","static/tags.ts","components/SampleTray/NewSampleTray/Packer.ts","components/SampleTray/NewSampleTray/rects.ts","components/SampleTray/NewSampleTray/CanvasItems/TagSelector.tsx","components/SampleTray/NewSampleTray/CanvasItems/Layers/TagsLayer.tsx","components/SampleTray/NewSampleTray/CanvasItems/SamplePath.tsx","components/SampleTray/NewSampleTray/CanvasItems/Layers/SampleLayer.tsx","components/SampleTray/NewSampleTray/CanvasItems/Layers/WidgetsLayer.tsx","components/SampleTray/NewSampleTray/CanvasItems/Navigation.tsx","components/SampleTray/NewSampleTray/Canvas.tsx","components/SampleTray/SampleTray.tsx","enums.ts","pages/Instrument.tsx","pages/Home.tsx","App.tsx","reportWebVitals.ts","IFrameValidator.ts","classes/CardData.ts","static/defaultLayouts.ts","classes/History.ts","model/appModel.ts","classes/WaveFormBuilder.ts","classes/ðŸŽ»CompositionData.ts","static/defaultCompositions.ts","model/ðŸŽ»compositionsModel.ts","static/cardDataSheetKey.ts","classes/ðŸ“‹GoogleSheetData.ts","model/googleSheetsModel.ts","model/historyModel.ts","classes/LayoutData.ts","model/layoutsModel.ts","model/logModel.ts","classes/SampleData.ts","static/placeHolderSamples.ts","model/samplesModel.ts","model/index.ts","store.ts","index.tsx"],"names":["typedHooks","createTypedHooks","useStoreActions","useStoreState","useStoreDispatch","Section","React","forwardRef","ref","children","className","backgroundColor","column","padding","width","height","flexStatus","style","borderRadius","backdropFilter","backgroundBlur","appConfig","sampleHeight","longestSample","gridUnit","window","innerWidth","canvasConfig","startMode","sampleContainerWidth","sampleListWidth","sampleTagWidth","widgetWidth","widgetHeight","sampleCollectionGroupX","sampleCollectionRectHeight","innerHeight","theme","primary","secondary","secondaryHover","primaryInactive","transparent","stroke","textDark","BasicSamplePath","memo","props","useState","isHovered","x","y","sampleRef","useRef","h","w","draggable","fill","onMouseDown","onDragStart","onDragEnd","onMouseEnter","onDragMove","onMouseUp","id","svgPath","sample","scaleX","getGradient","tags","console","log","data","scaleY","strokeWidth","stop1","stop2","includes","CollectionContainer","sampleCollection","appMode","cornerRadius","text","name","samples","map","s","i","samplePath","key","DialogBox","open","setOpen","containerStyle","display","position","left","bottom","overflow","color","handler","useEffect","listener","event","el","current","contains","target","document","addEventListener","removeEventListener","useOnClickOutside","dialogClass","classNames","hidden","ReactDOM","createPortal","getElementById","Kosima","reaction","this","KosimaFolder","randomElements","arr","count","len","length","lookup","tmp","index","Math","random","push","mapRange","value","inMin","inMax","outMin","outMax","KosimaRender","kosima","setPopOverOpen","useImage","baseImage","setReaction","reactionImage","expressionImage","xPos","yPos","hUnit","eyeHeight","eyePos","groupRef","eyeOffset","setEyeOffset","circRef","e","onMouseLeave","to","easing","Konva","Easings","EaseOut","onMouseMove","bBox","getClientRect","newX","evt","pageX","newY","pageY","image","radius","SampleCollection","CollectionNav","numSamples","sampleCollections","containerGroupRef","c","groupProps","rectProps","activeCollection","Tag","Packer","gutter","root","used","blocks","n","node","block","findNode","splitNode","fit","right","down","packSamples","forEach","calculateDimensions","TagSelector","activeTags","tag","setCircleFill","circleProps","hovered","setHovered","duration","EaseInOut","align","TagsLayer","removeTag","addTag","selectedTags","layerRef","element","opacity","withRadiusTags","t","allRadii","bigRadius","tagCircles","posX","cos","findPlace","posY","sin","asin","SamplePath","setRef","setisHovered","setabsolutePosition","isDragging","setIsDragging","gradient","fillPriority","absolutePosition","fillLinearGradientStartPoint","fillLinearGradientEndPoint","fillLinearGradientColorStops","renderGhost","SampleLayer","sampleTrayGroupRef","setSampleToClone","addToCurrentCollection","dragLayerRef","sampleToClone","setHoveredId","setPlayingSample","stageY","sampleLayerRef","sampleLayerProps","onRectMouseDown","onRectMouseUp","filter","filename","attrs","enriched","useMemo","intersect","setAttr","moveTo","toEnriched","drawSamples","r1","r2","WidgetsLayer","widgetContainerRef","timeLineRef","Array","from","keys","widgWidth","widgHeight","widgFill","groupX","groupY","trackGroupY","borderRectProps","a","rectX","widgets","NavItem","setAppMode","navItemStyle","onClick","Navigation","top","alignItems","margin","Canvas","state","samplesModel","stageContainerRef","sampleLayerWidth","packedSamples","packedRects","r","every","rows","list","Map","val","has","set","groupBy","f","size","packed","allTags","flatTags","reduce","prev","next","concat","getNumMatches","finalTags","get","defaultCollection1","slice","defaultCollection2","defaultCollection3","defaultCollection4","defaultCollection5","useLocalStore","action","toAddId","activeSamples","undefined","toClone","setActiveCollection","collectionName","availableTags","computed","tagToAdd","tagToRemove","hoveredId","playingSample","draggingId","popOverOpen","active","viewHeight","getBoundingClientRect","stageHeight","setStageHeight","setViewHeight","setStageY","max","min","mode","setDraggingId","playingId","devTools","actions","stageProps","onWheel","preventDefault","deltaY","currentSample","stageNodeRef","container","useKeyboardShortcut","keyCode","disabled","draggingRef","containerHeight","sampleTrayGroupY","targY","targX","playing","progressInterval","onProgress","played","playedSeconds","loaded","loadedSeconds","url","src","getChildren","array","valToFind","numMatches","j","DropCategory","DragSource","InteractionType","AppMode","Composition","SampleTray","_state","sampleTrayClass","tagFilter","Instrument","Home","justifyContent","flexDirection","fontSize","maxWidth","process","App","fetchCardDataGoogleSheetThunk","googleSheetsModel","fetchAppGoogleSheet","processCompositions","compositionsModel","fetchCompositionSheet","fetchCompositionsSheet","fetchSamples","fetchSamplesSheet","initialValue","setValue","useToggle","toggleSampleTrayIsActive","path","component","exact","reportWebVitals","onPerfEntry","Function","then","getCLS","getFID","getFCP","getLCP","getTTFB","IFrameLoadError","IFrameLoadWarning","IFrameValidator","errors","warnings","xoCheckArray","errorsArray","test","contentWindow","message","CROSS_ORIGIN","checkForXO","malformedUrlCheckArray","str","warningsArray","RegExp","MALFORMED_URL","validURL","CardData","row","title","added","sourceId","author","interaction","validator","isActive","failed","Date","b","defaultGridLayoutArray","static","defaultLayouts","lg","md","sm","xs","xxs","JSON","stringify","History","events","currentStep","appModel","availableCards","activeCards","currentLayout","defaultGridLayout","DISPLAY","history","manageViewModeChange","thunk","viewModeEnum","EDIT","CYCLE","toggleViewMode","_","getState","setCurrentLayout","layoutArray","setAvailableCards","cardDataArray","setActiveCards","onCardSheetLoadSuccess","actionOn","storeActions","setAppGoogleSheetData","cards","payload","getSheetRows","sourceid","debug","onSetActiveLayout","thunkOn","layoutsModel","setActiveLayout","layout","activeSources","sources","availableCardsUpdated","card","setActive","registerCardLoadFailure","failedCard","getStoreState","failedId","newCards","fail","onSwapCardContent","swapCardContent","targetId","newSource","find","onUndoHistory","historyModel","setCurrentHistory","onRedoHistory","WaveFormBuilder","collectSamplePoints","sampleDuration","svgViewBoxWidth","points","currentTime","channel1","channel","valueAtTime","at_time","maxSampleVal","max_sample","percentageComplete","xValue","yValue","timePointValue","round","topPoints","p","reversePoints","reverse","newPoint","allPoints","SVGCatmullRomSpline","toPath","audioContext","getAudio","fetch","response","arrayBuffer","buffer","options","audio_context","array_buffer","scale","Promise","resolve","reject","WaveformData","createFromAudio","err","waveform","error","AudioContext","original","pathData","setPath","catch","CompositionData","waveFormData","d","defaultCompositions","bachMovement1","genearteDefaultCompositions","compositions","processor","analysisResults","allSettled","results","succesfulAnalaysisCompositions","result","comp","status","setCompositions","downloadAnalysis","samplesArray","toJSON","csv","Papa","unparse","Blob","type","cardDataSheetKey","sheet_number","GoogleSheetData","sheetId","sheets","sheetIndex","apikey","GoogleSpreadsheet","useApiKey","sheetPromiseArray","loadInfo","sheetsByIndex","myTest","getRows","layoutDataGoogleSheet","cardDataGoogleSheet","appGoogleSheet","samplesSheet","compositionsSheet","publicSheetUrl","parseSheet","setCompositionsSheet","setSamplesSheet","prototype","loadSheets","all","responseData","studentsGoogleSheet","googleSheet","setCardDataGoogleSheet","sheet","setLayoutDataGoogleSheet","compositionSheet","complete","parse","download","header","file","endsWith","undoHistory","undoIt","undo","redoIt","redo","addEditHistory","layouts","addEditEvent","LayoutData","timestamp","split","startLayout","swapInfo","Object","entries","k","v","toRemove","l","toAdd","pos","newItem","toFail","newGridLayout","activeLayout","externalLayouts","bufferLayout","tempLayout","onSetAppGoogleSheetData","dLayout","defaultLayout","setExternalLayouts","setBufferLayout","onToggleViewModeListener","buf","newActiveLayout","newLayoutArray","getStoreActions","swapCard","deleteCard","cardToDelete","removeCard","addCard","cardAddEvent","targetPosition","cardToAdd","setGridLayout","failCard","setTempLayout","updateLayout","swap","old","logModel","setData","SampleData","sampleDataRow","composition","startTime","endTime","konvaObject","starTime","hour","defaultStartTime","defaultEndTime","containerWidth","rowHeight","placeHolderSamplePaths","placeHolderSamples","defaultSamples","sampleUrl","basicRow","date","sampleD","makeDefaultSamples","draggingSample","onSetSamplesSheets","rawSampleRows","sampleDataArray","setSamples","processSamples","processedSamples","generateSVG","succesfulAnalaysisSamples","loadSamples","setDraggingSample","model","appData","historyData","compositonsModel","store","createStore","middleware","logger","render"],"mappings":"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","file":"static/js/main.f7857fa1.chunk.js","sourcesContent":["import React, { useState } from \"react\";\r\n\r\nimport { StoreModel } from \"./model\";\r\nimport { createTypedHooks } from \"easy-peasy\";\r\nimport { useArray } from \"react-hanger\";\r\n\r\nconst typedHooks = createTypedHooks<StoreModel>();\r\n\r\n// We export the hooks from our store as they will contain the\r\n// type information on them\r\n// see https://easy-peasy.vercel.app/docs/api/use-store-actions.html for more on store hooks\r\nexport const useStoreActions = typedHooks.useStoreActions;\r\nexport const useStoreDispatch = typedHooks.useStoreDispatch;\r\nexport const useStoreState = typedHooks.useStoreState;\r\n\r\nexport function useToggle(initialValue: boolean): [boolean, () => void] {\r\n  const [value, setValue] = useState<boolean>(initialValue);\r\n\r\n  const toggleValue = () => setValue(!value);\r\n\r\n  return [value, toggleValue];\r\n}\r\n\r\nexport { useArray };\r\n\r\nconst test = \"test\";\r\n\r\nimport { RefObject, useEffect } from \"react\";\r\n\r\ntype AnyEvent = MouseEvent | TouchEvent;\r\n\r\nexport function useOnClickOutside<T extends HTMLElement = HTMLElement>(\r\n  ref: RefObject<T>,\r\n  handler: (event: AnyEvent) => void\r\n): void {\r\n  useEffect(() => {\r\n    const listener = (event: AnyEvent) => {\r\n      const el = ref?.current;\r\n\r\n      // Do nothing if clicking ref's element or descendent elements\r\n      if (!el || el.contains(event.target as Node)) {\r\n        return;\r\n      }\r\n\r\n      handler(event);\r\n    };\r\n\r\n    document.addEventListener(`mousedown`, listener);\r\n    document.addEventListener(`touchstart`, listener);\r\n\r\n    return () => {\r\n      document.removeEventListener(`mousedown`, listener);\r\n      document.removeEventListener(`touchstart`, listener);\r\n    };\r\n\r\n    // Reload only if ref or handler changes\r\n  }, [ref, handler]);\r\n}\r\n\r\n// export function useAppMode()\r\n","import React, { useState, useEffect} from \"react\";\r\nimport {Pane} from \"evergreen-ui\";\r\nimport \"@css/Section.scss\";\r\n\r\ninterface SectionProperties{\r\n  children: JSX.Element | JSX.Element[];\r\n  className?: string;\r\n  backgroundColor?: string\r\n  column?: boolean; \r\n  padding?: string;\r\n  width?: string | number;\r\n  height?: string | number;\r\n  backgroundBlur?: boolean;\r\n}\r\n// const Component = React.forwardRef<RefType, PropsType>((props, ref) => {\r\n// eslint-disable-next-line react/display-name\r\nconst Section = React.forwardRef<HTMLDivElement, SectionProperties>(({children, className, backgroundColor, column, padding, width, height, backgroundBlur}, ref) => {\r\n  const flexStatus = column?\"flex-column \":\"flex-row \"\r\n  const style = {\r\n    backgroundColor: backgroundColor??\"rgba(0,0,0,0)\",\r\n    padding: padding,\r\n    borderRadius: \"1em\",\r\n    width: width??\"100%\", \r\n    height: height??\"100%\",\r\n    backdropFilter: backgroundBlur?\"blur(10px)\":\"\",\r\n  }\r\n  return(\r\n    <div className = {\"ui-section \" + flexStatus + className??\"\"}style = {style} ref = {ref}>\r\n    {/* <Pane ref = {ref} className = {\"ui-section \" + flexStatus + className??\"\"}width = {\"100%\"} height = {\"100%\"} backgroundColor = {backgroundColor??\"lightgrey\"} padding = {padding??\"1em\"} borderRadius = {\"1em\"}> */}\r\n        {children} \r\n    {/* </Pane> */}\r\n    </div>\r\n  )\r\n})\r\n\r\nexport default Section\r\n","export interface AppConfig {\r\n  sampleHeight: number;\r\n  longestSample: number;\r\n}\r\n\r\nconst appConfig = {\r\n  sampleHeight: 40,\r\n  longestSample: 5,\r\n};\r\n\r\nexport default appConfig;\r\n","import { AppMode } from \"@components/SampleTray/NewSampleTray/Canvas\";\r\n\r\ninterface CanvasConfig {\r\n  startMode: AppMode;\r\n  sampleContainerWidth: number;\r\n  sampleListWidth: number;\r\n  sampleTagWidth: number;\r\n  widgetWidth: number;\r\n  widgetHeight: number;\r\n  sampleCollectionGroupX: number;\r\n  sampleCollectionRectHeight: number;\r\n}\r\n\r\nconst gridUnit = window.innerWidth / 12;\r\nconst canvasConfig: CanvasConfig = {\r\n  startMode: \"samples\",\r\n  sampleContainerWidth: gridUnit * 2,\r\n  sampleListWidth: gridUnit * 5,\r\n  sampleTagWidth: gridUnit * 4,\r\n  widgetWidth: 300,\r\n  widgetHeight: 300,\r\n  sampleCollectionGroupX: 50,\r\n  sampleCollectionRectHeight: window.innerHeight - 100,\r\n};\r\n\r\nexport default canvasConfig;\r\n","export interface Theme {\r\n  primary: string;\r\n  primaryInactive: string;\r\n  secondary: string;\r\n  secondaryHover: string;\r\n  stroke: string;\r\n  transparent: string;\r\n  borderRadius: number;\r\n  textDark: string;\r\n}\r\n\r\nconst theme = {\r\n  primary: \"#333333\",\r\n  // primary: \"#121212\",\r\n  // primary: \"#989898\",\r\n  secondary: \"#FFC300\",\r\n  secondaryHover: \"#b38900\",\r\n  primaryInactive: \"#4c4c4c\",\r\n  transparent: \"#0000\",\r\n  stroke: \"black\",\r\n  borderRadius: 10,\r\n  textDark: \"black\",\r\n};\r\n\r\nexport default theme;\r\n","import Konva from \"konva\";\r\nimport SampleData from \"@classes/SampleData\";\r\nimport { Group, Layer, Path, Rect, Stage, Text, Circle } from \"react-konva\";\r\nimport { KonvaEventObject } from \"konva/lib/Node\";\r\nimport { groupBy, mapRange } from \"@utils\";\r\nimport React, { MutableRefObject, RefObject, useRef, useState } from \"react\";\r\nimport { PathConfig } from \"konva/lib/shapes/Path\";\r\n\r\nexport interface BasicSample extends PathConfig {\r\n  sample: SampleData;\r\n  setRef?: (ref: RefObject<Konva.Path>) => void;\r\n  // onDragMove: (e: KonvaEventObject<DragEvent>) => void;\r\n  // onDragStart: (e: KonvaEventObject<DragEvent>) => void;\r\n  // onDragEnd: (e: KonvaEventObject<DragEvent>) => void;\r\n  // onMouseEnter: (e: KonvaEventObject<MouseEvent>) => void;\r\n  // onMouseDown: (e: KonvaEventObject<MouseEvent>) => void;\r\n  // onMouseUp: (e: KonvaEventObject<MouseEvent>) => void;\r\n  // draggable: boolean;\r\n  // fill: string;\r\n}\r\n\r\n// packedSamples: computed((state)=>{\r\n//   return packedSamples.packed.map((sample) => {\r\n//     state.activeTags.every(t=>sample.tags.includes(t))\r\n//   })\r\n// }),\r\n\r\nconst BasicSamplePath = React.memo((props: BasicSample): JSX.Element => {\r\n  const [isHovered, setisHovered] = useState(false);\r\n  const [absolutePosition, setabsolutePosition] = useState({ x: 0, y: 0 });\r\n  const sampleRef = useRef<Konva.Path>(null);\r\n\r\n  const {\r\n    w,\r\n    h,\r\n    width,\r\n    fill,\r\n    onMouseDown,\r\n    onDragStart,\r\n    onDragEnd,\r\n    onMouseEnter,\r\n    onDragMove,\r\n    onMouseUp,\r\n    draggable,\r\n    id,\r\n    svgPath,\r\n    sample,\r\n    x,\r\n    y,\r\n    scaleX,\r\n    // isHovered,\r\n  } = props;\r\n\r\n  const startPoint = { x: x, y: y };\r\n  // const startPoint = { x: 0, y: 0 };\r\n  const endPoint = { x: x + w, y: y + h };\r\n  const gradient = getGradient(sample.tags);\r\n  console.log(svgPath);\r\n  return (\r\n    <Path\r\n      x={x}\r\n      y={y}\r\n      ref={sampleRef}\r\n      width={width}\r\n      height={h}\r\n      id={id}\r\n      // y={h / 2}\r\n      data={sample.svgPath}\r\n      scaleX={scaleX}\r\n      scaleY={isHovered ? 1.1 : 1}\r\n      // fillPriority={\"linear-gradient\"}\r\n      // fill={fill}\r\n      fill={\"red\"}\r\n      // onMouseUp={onMouseUp}\r\n      // onMouseDown={(e) => {\r\n      //   console.log(e.target.absolutePosition());\r\n      //   setabsolutePosition(e.target.absolutePosition());\r\n      //   onMouseDown(e);\r\n      // }}\r\n      // onDragStart={onDragStart}\r\n      // onDragEnd={onDragEnd}\r\n      // onMouseEnter={(e) => {\r\n      //   onMouseEnter(e);\r\n      //   setisHovered(true);\r\n      // }}\r\n      // onMouseLeave={(e) => {\r\n      //   onMouseEnter(e);\r\n      //   setisHovered(false);\r\n      // }}\r\n      // dragBoundFunc={(e) => {\r\n      //   // console.log(e);\r\n      //   // return { x: x, y: y };\r\n      //   // return null;\r\n      //   return absolutePosition;\r\n      //   // return { x: 0, y: 0 };\r\n      // }}\r\n      // fillLinearGradientStartPoint={{ x: 0, y: 0 }}\r\n      // fillLinearGradientEndPoint={{ x: w, y: h }}\r\n      // fillLinearGradientColorStops={gradient}\r\n      // onDragMove={(e) => {\r\n      //   onDragMove(e);\r\n      // }}\r\n      draggable={draggable}\r\n      stroke={isHovered ? \"white\" : \"black\"}\r\n      strokeWidth={isHovered ? 2 : 2}\r\n    />\r\n  );\r\n});\r\nconst getGradient = (tags: string[]): (string | number)[] => {\r\n  let stop1 = \"blue\";\r\n  let stop2 = \"yellow\";\r\n\r\n  if (tags.includes(\"MR\")) {\r\n    stop1 = \"#3023AE\";\r\n    stop2 = \"#53A0FD\";\r\n    // console.log(\"HAD AN MR\");\r\n  }\r\n  if (tags.includes(\"LR\")) {\r\n    stop1 = \"#8c34eb\";\r\n    stop2 = \"#d034eb\";\r\n  }\r\n  if (tags.includes(\"LR\")) {\r\n    stop1 = \"#ebd510\";\r\n    stop2 = \"#eb8110\";\r\n  }\r\n  if (tags.includes(\"MIX\")) {\r\n    stop1 = \"#60eb10\";\r\n    stop2 = \"#2a10eb\";\r\n  }\r\n\r\n  return [0, stop1, 0.5, stop2, 1, stop1];\r\n};\r\nexport default BasicSamplePath;\r\n","import SampleCollection from \"@classes/SampleCollection\";\r\nimport appConfig from \"@static/appConfig\";\r\nimport canvasConfig from \"@static/canvasConfig\";\r\nimport theme from \"@static/theme\";\r\nimport React, { MutableRefObject } from \"react\";\r\nimport { Group, Rect, Text } from \"react-konva\";\r\nimport { AppMode } from \"../Canvas\";\r\nimport BasicSamplePath from \"./BasicSamplePath\";\r\n\r\nconst CollectionContainer = ({\r\n  sampleCollection,\r\n  appMode,\r\n}: {\r\n  sampleCollection: SampleCollection;\r\n  appMode: AppMode;\r\n}): JSX.Element => {\r\n  console.log(\"RENDERING COLLECTION CONTAINER\");\r\n\r\n  return (\r\n    <>\r\n      <Rect\r\n        fill={theme.stroke}\r\n        height={window.innerHeight - 100}\r\n        width={canvasConfig.sampleContainerWidth}\r\n        stroke={theme.primaryInactive}\r\n        strokeWidth={2}\r\n        cornerRadius={5}\r\n      />\r\n      <Text text={sampleCollection.name} />\r\n      {sampleCollection.samples.map((s, i) => {\r\n        const padding = 20;\r\n        const samplePath = {\r\n          x: 20,\r\n          y: appConfig.sampleHeight * i + appConfig.sampleHeight / 2 + padding,\r\n          sample: s,\r\n          h: appConfig.sampleHeight,\r\n          width: 10,\r\n          scaleX: 0.5,\r\n        };\r\n        return <BasicSamplePath key={i} {...samplePath} />;\r\n      })}\r\n    </>\r\n  );\r\n};\r\n\r\nexport default React.memo(CollectionContainer);\r\n","import theme from \"@static/theme\";\r\nimport React, { useState, useEffect, useRef } from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"@css/DialogBox.scss\";\r\nimport classNames from \"classnames\";\r\nimport { useOnClickOutside } from \"@hooks\";\r\n\r\nconst DialogBox = ({\r\n  open,\r\n  setOpen,\r\n}: {\r\n  open: boolean;\r\n  setOpen: (open: boolean) => void;\r\n}): JSX.Element => {\r\n  const widthPercent = 25;\r\n  const leftPercent = 50 - widthPercent / 2;\r\n\r\n  const containerStyle = {\r\n    width: `${widthPercent}%`,\r\n    height: 200,\r\n    display: open ? \"flex\" : \"none\",\r\n    backgroundColor: theme.secondary,\r\n    borderRadius: theme.borderRadius,\r\n    position: \"absolute\",\r\n    left: `${leftPercent}%`,\r\n    bottom: \"25%\",\r\n    overflow: \"hidden\",\r\n    color: theme.textDark,\r\n    // transform: \"translate(-50%, -50%)\",\r\n    padding: \"1em\",\r\n  } as React.CSSProperties;\r\n\r\n  const handleClickOutside = () => {\r\n    setOpen(false);\r\n    console.log(\"clicked outside\");\r\n  };\r\n\r\n  const ref = useRef(null);\r\n  useOnClickOutside(ref, handleClickOutside);\r\n\r\n  const dialogClass = classNames(\"dialog\", {\r\n    hidden: !open,\r\n    \"dialog-display\": open,\r\n  });\r\n\r\n  return ReactDOM.createPortal(\r\n    <div className={dialogClass} style={containerStyle} ref={ref}>\r\n      <p>\r\n        Lorem Ipsum is simply dummy text of the printing and typesetting\r\n        industry. Lorem Ipsum has been the industry's standard dummy text ever\r\n        since the 1500s, when an unknown printer took a galley of type and\r\n        scrambled it to make a type specimen book. It has survived not only five\r\n        centuries, but also the leap into electronic typesetting, remaining\r\n        essentially unchanged. It was popularised in the 1960s with the release\r\n        of Letraset sheets containing Lorem Ipsum passages, and more recently\r\n        with desktop publishing software like Aldus PageMaker including versions\r\n        of Lorem Ipsum.\r\n      </p>\r\n    </div>,\r\n    document.getElementById(\"dialog-box\") as HTMLDivElement\r\n  );\r\n};\r\n\r\nexport default DialogBox;\r\n","type KosimaReaction =\r\n  | \"KOSIMA_SURPRISE\"\r\n  | \"KOSIMA_QUESTION\"\r\n  | \"KOSIMA_THINKING\"\r\n  | \"KOSIMA_NEUTRAL\";\r\n\r\nclass Kosima {\r\n  static KosimaFolder = process.env.PUBLIC_URL + \"/Kosima/\";\r\n  reaction!: KosimaReaction;\r\n  constructor() {\r\n    this.reaction = \"KOSIMA_NEUTRAL\";\r\n  }\r\n\r\n  reactionImage() {\r\n    console.log(Kosima.KosimaFolder + this.reaction + \".svg\");\r\n    return Kosima.KosimaFolder + this.reaction + \".svg\";\r\n  }\r\n  baseImage() {\r\n    return Kosima.KosimaFolder + \"KOSIMA_NEUTRAL\" + \".svg\";\r\n  }\r\n  setReaction(reaction: KosimaReaction) {\r\n    this.reaction = reaction;\r\n  }\r\n}\r\n\r\nexport default Kosima;\r\n","export function randomElements(arr: any[], count: number) {\n  let len = arr.length;\n  let lookup = {};\n  let tmp = [];\n\n  if (count > len) count = len;\n\n  for (let i = 0; i < count; i++) {\n    let index;\n    do {\n      index = ~~(Math.random() * len);\n    } while (index in lookup);\n    lookup[index] = null;\n    tmp.push(arr[index]);\n  }\n\n  return tmp;\n}\n\nexport function mapRange(\n  value: number,\n  inMin: number,\n  inMax: number,\n  outMin: number,\n  outMax: number\n): number {\n  // return Math.max( inMin, Math.min( outMax, unclamped ) );\n  return ((value - inMin) * (outMax - outMin)) / (inMax - inMin) + outMin;\n}\n\nexport function downloadBlob(\n  content: any,\n  filename: string,\n  contentType: string\n): void {\n  // Create a blob\n  const blob = new Blob([content], { type: contentType });\n  const url = URL.createObjectURL(blob);\n\n  // Create a link to download it\n  const pom = document.createElement(\"a\");\n  pom.href = url;\n  pom.setAttribute(\"download\", filename);\n  pom.click();\n}\n\nexport const groupBy = (list: any[], key: string): Map<string, Array<any>> => {\n  let map = new Map();\n  list.map((val) => {\n    if (!map.has(val[key])) {\n      map.set(\n        val[key],\n        list.filter((data) => data[key] == val[key])\n      );\n    }\n  });\n  return map;\n};\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport { Circle, Group, Image, Layer } from \"react-konva\";\r\nimport Kosima from \"@classes/Kosima\";\r\nimport useImage from \"use-image\";\r\nimport theme from \"@static/theme\";\r\nimport { mapRange } from \"@utils\";\r\nimport { group } from \"console\";\r\nimport Konva from \"konva\";\r\nimport { ActionCreator, Actions } from \"easy-peasy\";\r\nimport { CanvasModel } from \"../../Canvas\";\r\n\r\ninterface KosimaProperties\r\n  extends Pick<Actions<CanvasModel>, \"setPopOverOpen\"> {\r\n  kosima: Kosima;\r\n  // setPopOverOpen: (payload: boolean) => void\r\n}\r\n\r\nconst KosimaRender = ({\r\n  kosima,\r\n  setPopOverOpen,\r\n}: KosimaProperties): JSX.Element => {\r\n  const [baseImage] = useImage(kosima.baseImage());\r\n  kosima.setReaction(\"KOSIMA_QUESTION\");\r\n\r\n  const [expressionImage] = useImage(kosima.reactionImage());\r\n  // console.log(expressionImage.w);\r\n  const width = 150.0;\r\n  const height = 150.0;\r\n  console.log(expressionImage);\r\n\r\n  const xPos = (window.innerWidth - width) / 2;\r\n  const yPos = window.innerHeight - height - 50;\r\n  const eyeDiameter = 1;\r\n  const headHeight = 9;\r\n  const hUnit = height / headHeight;\r\n  const eyeHeight = 150 - 5 * hUnit;\r\n  // let eyeY = height - (eyeHeight / 2) * hUnit;\r\n  // eyeY -= (eyeDiameter * hUnit) / 2;\r\n  const eyeY = eyeHeight + (eyeDiameter / 2) * hUnit + eyeHeight / 2;\r\n\r\n  // const eyeY = eyeHeight / 2;\r\n  // const eyeY = height;\r\n\r\n  // eyeY += (eyeHeight / 2.0) * hUnit;\r\n\r\n  // let eyeY = eyeHeight * hUnit + (eyeHeight / 2) * hUnit;\r\n\r\n  // const eyeX = (width - eyeRadius) / 2;\r\n  // const eyeX = width / 2 - (eyeDiameter / 2) * hUnit;\r\n  const eyeX = (width - eyeDiameter) / 2;\r\n  const [eyePos, setEyePos] = useState({\r\n    x: eyeX,\r\n    y: eyeY,\r\n  });\r\n  const groupRef = useRef(null);\r\n  const [eyeOffset, setEyeOffset] = useState({ x: 0, y: 0 });\r\n  useEffect(() => {\r\n    // console.log(eyeOffset);\r\n  }, [eyeOffset]);\r\n  const maxEyeRadius = 15;\r\n  const circRef = useRef(null);\r\n\r\n  return (\r\n    <Layer\r\n      onMouseUp={(e) => {\r\n        setPopOverOpen(true);\r\n      }}\r\n      onMouseLeave={(e) => {\r\n        circRef.current.to({\r\n          x: eyePos.x,\r\n          y: eyePos.y,\r\n          easing: Konva.Easings.EaseOut,\r\n        });\r\n      }}\r\n      onMouseMove={(e) => {\r\n        console.log(groupRef);\r\n        if (groupRef.current) {\r\n          const bBox = groupRef.current.getClientRect();\r\n          console.log(bBox);\r\n          const newX = mapRange(\r\n            e.evt.pageX,\r\n            bBox.x,\r\n            bBox.x + bBox.width,\r\n            -maxEyeRadius,\r\n            maxEyeRadius\r\n          );\r\n          console.log(newX);\r\n          console.log(e);\r\n          console.log(e.evt.x);\r\n          console.log(e.evt.y);\r\n          const newY = mapRange(\r\n            e.evt.pageY,\r\n            bBox.y,\r\n            bBox.y + bBox.height,\r\n            -maxEyeRadius,\r\n            maxEyeRadius\r\n          );\r\n          setEyeOffset({ x: newX, y: newY });\r\n        }\r\n      }}\r\n    >\r\n      <Group x={xPos} y={yPos} ref={groupRef}>\r\n        <Image width={width} height={height} image={baseImage} />\r\n        {/* <Image width={width} height={height} image={expressionImage} /> */}\r\n        <Circle\r\n          ref={circRef}\r\n          x={eyePos.x + eyeOffset.x}\r\n          y={eyePos.y + eyeOffset.y}\r\n          fill={\"yellow\"}\r\n          radius={hUnit * 0.5}\r\n          stroke={theme.stroke}\r\n        />\r\n      </Group>\r\n    </Layer>\r\n  );\r\n};\r\n\r\nexport default React.memo(KosimaRender);\r\n","import SampleData from \"./SampleData\";\r\n\r\nclass SampleCollection {\r\n  samples!: SampleData[];\r\n  name!: string;\r\n\r\n  constructor(samples: SampleData[], name: string) {\r\n    this.samples = samples;\r\n    this.name = name;\r\n  }\r\n}\r\n\r\nexport default SampleCollection;\r\n","import SampleCollection from \"@classes/SampleCollection\";\r\nimport theme from \"@static/theme\";\r\nimport Konva from \"konva\";\r\nimport { KonvaEventObject } from \"konva/lib/Node\";\r\nimport { RectConfig } from \"konva/lib/shapes/Rect\";\r\nimport React, { useState, useEffect, useRef } from \"react\";\r\nimport { Group, Rect } from \"react-konva\";\r\n\r\ninterface CollectionNavProperties extends Partial<RectConfig> {\r\n  sampleCollections: SampleCollection[];\r\n  activeCollection: string;\r\n  // onMouseUp: (e: KonvaEventObject<MouseEvent>) => void;\r\n}\r\n\r\nconst CollectionNav = (props: CollectionNavProperties): JSX.Element => {\r\n  const height = 15;\r\n  const spacing = 5;\r\n  const numSamples = props.sampleCollections.length;\r\n  const containerGroupRef = useRef<Konva.Layer>(null);\r\n  const yPos =\r\n    window.innerHeight / 2 - (height * numSamples + spacing * numSamples) / 2;\r\n\r\n  return (\r\n    <Group>\r\n      <Group ref={containerGroupRef} y={yPos}>\r\n        {props.sampleCollections.map((c, i) => {\r\n          const groupProps = {\r\n            x: 10,\r\n            y: i * 15 + spacing,\r\n          };\r\n          const isActiveCollection = props.activeCollection === c.name;\r\n          const rectProps = {\r\n            fill: isActiveCollection ? theme.secondary : theme.primary,\r\n            stroke: theme.secondary,\r\n            width: height,\r\n            height: height,\r\n            id: c.name,\r\n            onMouseUp: props.onMouseUp,\r\n          };\r\n\r\n          return (\r\n            <Group key={i} {...groupProps}>\r\n              <Rect {...rectProps}></Rect>\r\n            </Group>\r\n          );\r\n        })}\r\n      </Group>\r\n    </Group>\r\n  );\r\n};\r\n\r\nexport default CollectionNav;\r\n","export default class Tag {\r\n  name: string;\r\n  count: number | undefined;\r\n\r\n  constructor(name: string, count: number) {\r\n    this.name = name;\r\n    this.count = count;\r\n  }\r\n}\r\n","type SampleTag = \"short\" |\"long\" | \"fast\" | \"upbeat\" | \"intense\" | \"dramatic\" |\"chaotic\"\r\n\r\nconst tags = [\"FD\", \"MR\", \"HR\", \"ST\", \"LT\", \"MIX\", \"LR\", \"E\", \"M\", \"FL\", \"C\", \"BACH\", \"BARTOK\", \"YSAYE\", \"TONE\", \"TRL\", \"T\"]\r\n// const tags = [\"FD\", \"MR\", \"HR\", \"ST\", \"LT\", \"MIX\", \"LR\", \"E\", \"M\", \"3L\", \"2L\", \"1L\", \"4L\", \"FL\", \"C\", \"BACH\", \"BARTOK\", \"YSAYE\"]\r\nexport default tags;\r\n\r\n\r\n// AIzaSyBo7S3o_RHuyBnG3Z7ywlvz3FbtKU9n0MQ","// export interface Block {\r\n//   [x: string]: any;\r\n//   w: number;\r\n//   h: number;\r\n//   fit?: PackNode;\r\n//   // id: string;\r\n// }\r\n\r\nimport SampleData from \"@classes/SampleData\";\r\n\r\nexport interface PackNode {\r\n  x: number;\r\n  y: number;\r\n  w: number;\r\n  h: number;\r\n  // id: string;\r\n  used?: boolean;\r\n  down?: PackNode;\r\n  right?: PackNode;\r\n}\r\n\r\nexport interface Piece {\r\n  x: number;\r\n  y: number;\r\n  w: number;\r\n  h: number;\r\n}\r\n\r\nexport interface Fit {\r\n  x: number;\r\n  y: number;\r\n}\r\n\r\nexport class Packer {\r\n  readonly w: number;\r\n  readonly h: number;\r\n  readonly root: PackNode;\r\n  readonly gutter: number;\r\n\r\n  constructor(w: number, h: number, gutter?: number) {\r\n    const margin = 40;\r\n    this.w = w;\r\n    this.h = h;\r\n    this.gutter = gutter ?? 5;\r\n    this.root = { x: margin, y: 0, w: w, h: h, used: false };\r\n  }\r\n  fit(blocks: SampleData[]): void {\r\n    let n, node, block;\r\n    for (n = 0; n < blocks.length; n++) {\r\n      block = blocks[n];\r\n      // block.w += this.gutter;\r\n      // block.h += this.gutter;\r\n      if ((node = this.findNode(this.root, block.w, block.h))) {\r\n        const fit = this.splitNode(node, block.w, block.h, block.id);\r\n        block.fit = this.splitNode(node, block.w, block.h, block.id);\r\n        // console.log(fit);\r\n      }\r\n\r\n      // console.log(this.splitNode(node, block.w, block.h, block.id));\r\n    }\r\n  }\r\n  findNode(root: PackNode, w: number, h: number): PackNode | null {\r\n    if (root.used && root.right && root.down)\r\n      return this.findNode(root.right, w, h) || this.findNode(root.down, w, h);\r\n    else if (w <= root.w && h <= root.h) return root;\r\n    else return null;\r\n  }\r\n  splitNode(node: PackNode, w: number, h: number, id: string): PackNode {\r\n    node.used = true;\r\n    node.down = {\r\n      x: node.x,\r\n      y: node.y + h,\r\n      w: node.w,\r\n      h: node.h - h,\r\n    };\r\n    node.right = {\r\n      x: node.x + w,\r\n      y: node.y,\r\n      w: node.w - w,\r\n      h: h,\r\n    };\r\n    return node;\r\n  }\r\n}\r\n\r\nexport default Packer;\r\n","import Packer from \"./Packer\";\r\nimport { RectConfig } from \"konva/lib/shapes/Rect\";\r\nimport SampleData from \"@classes/SampleData\";\r\nimport { mapRange } from \"@utils\";\r\nimport appConfig from \"@static/appConfig\";\r\n\r\nconst stageProps = {\r\n  width: window.innerWidth,\r\n  height: 800,\r\n};\r\n\r\nconst greens = [\r\n  \"#A4DE02\",\r\n  \"#76BA1B\",\r\n  \"#4C9A2A\",\r\n  \"#1E5631\",\r\n  \"#68BB59\",\r\n  \"#ACDF87\",\r\n];\r\n// const makeBlocks = (count: number, colWidth: number): Block[] => {\r\n//   let blocks = [];\r\n//   const widths = [1, 2, 3, 4, 5];\r\n//   for (let index = 0; index < count; index++) {\r\n//     const block = {\r\n//       w: randomElement(widths) * colWidth,\r\n//       h: 74,\r\n//     };\r\n//     blocks.push(block);\r\n//   }\r\n//   return blocks;\r\n// };\r\n\r\n// const packer = new Packer(stageProps.width, stageProps.height, 10);\r\n// const blocks = makeBlocks(25, stageProps.width / 10);\r\n// packer.fit(blocks);\r\n\r\nconst getSampleWidth2 = (sample: SampleData): number => {\r\n  const mapped = mapRange(sample.length, 0, 3.0, 5, 12);\r\n  const rounded = Math.round(mapped);\r\n  return rounded;\r\n};\r\n\r\n// const samplesToBlocks = (samples: SampleData[]): Block[] => {\r\n//   return samples.map((s) => {\r\n//     const w = getSampleWidth2(s);\r\n//     const h = 70;\r\n//     return {\r\n//       w: w,\r\n//       h: h,\r\n//       id: s.id,\r\n//     } as Block;\r\n//   });\r\n// };\r\n\r\nexport const packSamples = (\r\n  samples: SampleData[],\r\n  width: number,\r\n  height: number\r\n): SampleData[] => {\r\n  // const sampleBlocks = samplesToBlocks(samples);\r\n  console.log(\"PACKING SAMPLES\");\r\n  samples.forEach((sample) => {\r\n    sample.calculateDimensions(width, appConfig.sampleHeight);\r\n  });\r\n  const packer = new Packer(width, height, 10);\r\n  packer.fit(samples);\r\n  // console.log(samples);\r\n  return samples;\r\n};\r\n\r\nfunction randomElement<T>(array: T[]): T {\r\n  return array[Math.floor(Math.random() * array.length)];\r\n}\r\n\r\n// const rects = makeRects(blocks);\r\nconst rects = [];\r\nexport default rects;\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport { Circle, Group, Text } from \"react-konva\";\r\nimport { CircleConfig } from \"konva/lib/shapes/Circle\";\r\nimport Tag from \"@classes/Tag\";\r\nimport Konva from \"konva\";\r\nimport theme from \"@static/theme\";\r\n\r\nexport interface TagSelectorProps extends Partial<CircleConfig> {\r\n  tag: Tag;\r\n  activeTags: string[];\r\n}\r\n\r\nconst TagSelector = (props: TagSelectorProps): JSX.Element => {\r\n  const {\r\n    activeTags,\r\n    x,\r\n    y,\r\n    tag,\r\n    w,\r\n    h,\r\n    fill,\r\n    radius,\r\n    onMouseDown,\r\n    onDragStart,\r\n    onDragEnd,\r\n    onMouseEnter,\r\n    // onMouseExit,\r\n    onDragMove,\r\n    onMouseUp,\r\n    draggable,\r\n    id,\r\n    fit,\r\n    stroke,\r\n    strokeWidth,\r\n    // isHovered,\r\n  } = props;\r\n\r\n  useEffect(() => {\r\n    console.log(x, y);\r\n    groupRef.current.to({\r\n      x: x,\r\n      y: y,\r\n    });\r\n  }, [x, y]);\r\n\r\n  const groupRef = useRef(null);\r\n  const groupProps = {\r\n    // y,\r\n    // x,\r\n    onMouseDown,\r\n    onDragStart,\r\n    onDragEnd,\r\n    onMouseEnter,\r\n    onDragMove,\r\n    onMouseUp,\r\n    draggable,\r\n    id,\r\n  };\r\n\r\n  const [isActive, setIsActive] = useState(activeTags.includes(props.tag.name));\r\n  const [circleFill, setCircleFill] = useState(fill);\r\n  const circleProps = { strokeWidth };\r\n  const [hovered, setHovered] = useState(false);\r\n  const circRef = useRef(null);\r\n  useEffect(() => {\r\n    // console.log(activeTags);\r\n    if (activeTags.includes(tag.name)) {\r\n      setCircleFill(theme.secondary);\r\n    } else {\r\n      setCircleFill(fill);\r\n    }\r\n  }, [activeTags]);\r\n\r\n  useEffect(() => {\r\n    // console.log(radius);\r\n    circRef.current.to({\r\n      radius: radius,\r\n      duration: 0.3,\r\n      easing: Konva.Easings.EaseInOut,\r\n    });\r\n  }, [radius]);\r\n\r\n  return (\r\n    <Group {...groupProps} ref={groupRef}>\r\n      <Circle\r\n        onMouseEnter={(e) => {\r\n          setHovered(true);\r\n          //   e.target.attrs.fill = theme.secondary_hover;\r\n          //   onMouseEnter(e);\r\n        }}\r\n        onMouseLeave={(e) => {\r\n          setHovered(false);\r\n        }}\r\n        id={`tag_${tag.name}_circle`}\r\n        {...circleProps}\r\n        stroke={tag.count === 0 ? theme.primaryInactive : stroke}\r\n        fill={\r\n          tag.count == 0\r\n            ? theme.primary\r\n            : hovered\r\n            ? theme.secondaryHover\r\n            : theme.stroke\r\n        }\r\n        // fill={\"green\"}\r\n        ref={circRef}\r\n      />\r\n      <Text\r\n        x={-radius}\r\n        fill={\"white\"}\r\n        text={tag.name}\r\n        align={\"center\"}\r\n        width={radius * 2}\r\n      />\r\n    </Group>\r\n  );\r\n};\r\n\r\nexport default React.memo(TagSelector);\r\n","import Tag from \"@classes/Tag\";\r\nimport theme from \"@static/theme\";\r\nimport { mapRange } from \"@utils\";\r\nimport { ActionCreator, Actions } from \"easy-peasy\";\r\nimport { KonvaEventObject } from \"konva/lib/Node\";\r\nimport { CircleConfig } from \"konva/lib/shapes/Circle\";\r\nimport React, { useState, useEffect, useRef } from \"react\";\r\nimport { Circle, Layer } from \"react-konva\";\r\nimport { AppMode, CanvasModel } from \"../../Canvas\";\r\nimport TagSelector, { TagSelectorProps } from \"../TagSelector\";\r\n\r\ninterface TagsLayerProps\r\n  extends Pick<Actions<CanvasModel>, \"removeTag\" | \"addTag\"> {\r\n  appMode: AppMode;\r\n  tags: Tag[];\r\n  selectedTags: string[];\r\n}\r\nconst TagsLayer = ({\r\n  appMode,\r\n  tags,\r\n  removeTag,\r\n  addTag,\r\n  selectedTags,\r\n}: TagsLayerProps): JSX.Element => {\r\n  const layerRef = useRef(null);\r\n\r\n  // useEffect(() => {\r\n  if (appMode !== \"samples\") {\r\n    if (layerRef.current) {\r\n      layerRef.current.children.forEach((element) => {\r\n        element.to({\r\n          opacity: 0,\r\n          // scale: 0,\r\n          duration: 0.1,\r\n        });\r\n      });\r\n    }\r\n  } else {\r\n    if (layerRef.current) {\r\n      layerRef.current.children.forEach((element) => {\r\n        element.to({\r\n          opacity: 1,\r\n          // scale: 0,\r\n          duration: 0.5,\r\n        });\r\n      });\r\n    }\r\n  }\r\n  // }, [appMode]);\r\n\r\n  useEffect(() => {\r\n    console.log(tags);\r\n  }, [tags]);\r\n\r\n  const withRadiusTags = tags.map((t) => {\r\n    console.log(t.count);\r\n    // const circleRadius = mapRange(t.count, 0, 360, 50, 150);\r\n    const circleRadius = mapRange(t.count, 0, 170, 20, 80);\r\n    return {\r\n      tag: t,\r\n      radius: circleRadius,\r\n    };\r\n  });\r\n\r\n  const allRadii = withRadiusTags.map((t) => t.radius);\r\n  const bigRadius = 200;\r\n  // let testRadii = allRadii.map(r=>mapRange())\r\n  console.log(allRadii);\r\n  let xPos = window.innerWidth - bigRadius - 100;\r\n  let yPos = window.innerHeight / 2;\r\n  const tagCircles = withRadiusTags.map((tag, i) => {\r\n    let posX = bigRadius * Math.cos(findPlace(i, bigRadius, allRadii));\r\n    let posY = bigRadius * Math.sin(findPlace(i, bigRadius, allRadii));\r\n    posX += xPos;\r\n    posY += yPos;\r\n\r\n    const onMouseUp = (e: KonvaEventObject<MouseEvent>): void => {\r\n      console.log(\"got circle mouse up\");\r\n      console.log(tag);\r\n      if (selectedTags.includes(tag.tag.name)) {\r\n        removeTag(tag.tag.name);\r\n      } else {\r\n        addTag(tag.tag.name);\r\n      }\r\n      console.log(selectedTags);\r\n    };\r\n\r\n    return {\r\n      activeTags: selectedTags,\r\n      tag: tag.tag,\r\n      key: i,\r\n      radius: tag.radius,\r\n      fill: theme.primary,\r\n      x: posX,\r\n      y: posY,\r\n      stroke: theme.secondary,\r\n      strokeWidth: 5,\r\n      onMouseUp,\r\n    };\r\n  });\r\n\r\n  return (\r\n    <Layer ref={layerRef}>\r\n      <Circle x={xPos} y={yPos} radius={bigRadius} stroke={\"red\"} />\r\n      {tagCircles.map((c, i) => {\r\n        return <TagSelector {...c} key={i} />;\r\n      })}\r\n    </Layer>\r\n  );\r\n};\r\n\r\nexport default TagsLayer;\r\n\r\n//from https://stackoverflow.com/questions/69684506/arrange-circles-along-circle-without-overlap/69685450#69685450\r\nfunction findPlace(i: number, bigRadius: number, allRadii: number[]): number {\r\n  // console.log(i, bigRadius, allRadii[i], allRadii);\r\n  // console.log(Math.);\r\n  if (i < 1) {\r\n    return 0;\r\n  } else {\r\n    console.log(\r\n      i,\r\n      allRadii[i],\r\n      allRadii[i - 1],\r\n      bigRadius,\r\n      (2 * bigRadius) / (allRadii[i] + allRadii[i - 1]),\r\n      Math.asin((2 * bigRadius) / (allRadii[i] + allRadii[i - 1])),\r\n      Math.asin(i),\r\n      i - 1\r\n    );\r\n  }\r\n  return (\r\n    findPlace(i - 1, bigRadius, allRadii) +\r\n    Math.asin((allRadii[i] * 2 + allRadii[i - 1] * 2) / (2 * bigRadius))\r\n  );\r\n}\r\n","import Konva from \"konva\";\r\nimport SampleData from \"@classes/SampleData\";\r\nimport { Group, Layer, Path, Rect, Stage, Text, Circle } from \"react-konva\";\r\nimport { KonvaEventObject } from \"konva/lib/Node\";\r\nimport { groupBy, mapRange } from \"@utils\";\r\nimport React, { MutableRefObject, RefObject, useRef, useState } from \"react\";\r\nimport theme from \"@static/theme\";\r\n\r\nexport interface EnrichedSample\r\n  extends Omit<SampleData, \"setPath\" | \"calculateDimensions\"> {\r\n  onDragMove: (e: KonvaEventObject<DragEvent>) => void;\r\n  onDragStart: (e: KonvaEventObject<DragEvent>) => void;\r\n  onDragEnd: (e: KonvaEventObject<DragEvent>) => void;\r\n  onMouseEnter: (e: KonvaEventObject<MouseEvent>) => void;\r\n  onMouseDown: (e: KonvaEventObject<MouseEvent>) => void;\r\n  onMouseUp: (e: KonvaEventObject<MouseEvent>) => void;\r\n  draggable: boolean;\r\n  fill: string;\r\n}\r\n\r\n// packedSamples: computed((state)=>{\r\n//   return packedSamples.packed.map((sample) => {\r\n//     state.activeTags.every(t=>sample.tags.includes(t))\r\n//   })\r\n// }),\r\n\r\nconst SamplePath = React.memo(\r\n  ({\r\n    sample,\r\n    ref,\r\n    setRef,\r\n  }: // setSample,\r\n  {\r\n    sample: EnrichedSample;\r\n    ref?: MutableRefObject<Konva.Path>;\r\n    setRef?: (ref: RefObject<Konva.Path>) => void;\r\n  }): JSX.Element => {\r\n    const {\r\n      w,\r\n      h,\r\n      fill,\r\n      onMouseDown,\r\n      onDragStart,\r\n      onDragEnd,\r\n      onMouseEnter,\r\n      onDragMove,\r\n      onMouseUp,\r\n      draggable,\r\n      id,\r\n      svgPath,\r\n      fit,\r\n      // isHovered,\r\n    } = sample;\r\n    const [isHovered, setisHovered] = useState(false);\r\n    const [absolutePosition, setabsolutePosition] = useState({ x: 0, y: 0 });\r\n    const sampleRef = useRef<Konva.Path>(null);\r\n    const [isDragging, setIsDragging] = useState(false);\r\n\r\n    // const [sampleRef, setSampleRef] = useState<()\r\n    // useEffect(() => {\r\n    //   console.log(hoveredId);\r\n    // setisHovered(hoveredId === id);\r\n    // }, [hoveredId]);\r\n    const actualWidth = mapRange(sample.w, 0, 2.5, 0, 400);\r\n\r\n    const { x, y } = fit;\r\n    const startPoint = { x: x, y: y };\r\n    // const startPoint = { x: 0, y: 0 };\r\n    const endPoint = { x: x + w, y: y + h };\r\n    const gradient = getGradient(sample.tags);\r\n    // console.log(svgPath);\r\n    const renderGhost = () => {\r\n      if (isDragging) {\r\n        return (\r\n          <Path\r\n            //  ref={sampleRef}\r\n            width={w}\r\n            height={h}\r\n            id={`ghost_${id}`}\r\n            y={h / 2}\r\n            data={svgPath}\r\n            scaleX={isHovered ? 1.1 : 1}\r\n            scaleY={isHovered ? 1.1 : 1}\r\n            fillPriority={\"linear-gradient\"}\r\n            // fill={fill}\r\n            stroke={theme.secondary}\r\n            strokeWidth={2}\r\n            // onMouseUp={onMouseUp}\r\n          />\r\n        );\r\n      }\r\n    };\r\n    return (\r\n      <Group x={x} y={y} width={w} height={h}>\r\n        <Path\r\n          ref={sampleRef}\r\n          width={w}\r\n          height={h}\r\n          id={id}\r\n          // y={h / 2}\r\n          data={svgPath}\r\n          // scaleX={isHovered ? 1.1 : 1}\r\n          scaleX={0.2}\r\n          scaleY={0.6}\r\n          // scaleY={isHovered ? 1.1 : 1}\r\n          fillPriority={\"linear-gradient\"}\r\n          // fill={fill}\r\n          // fill={fill}\r\n          onMouseUp={onMouseUp}\r\n          onMouseDown={(e) => {\r\n            console.log(e.target.absolutePosition());\r\n            setabsolutePosition(e.target.absolutePosition());\r\n            onMouseDown(e);\r\n          }}\r\n          onDragStart={(e) => {\r\n            setIsDragging(true);\r\n            onDragStart;\r\n          }}\r\n          onDragEnd={(e) => {\r\n            setIsDragging(false);\r\n            e.target.x(0);\r\n            e.target.y(h / 2);\r\n            onDragEnd(e);\r\n          }}\r\n          onMouseEnter={(e) => {\r\n            onMouseEnter(e);\r\n            setisHovered(true);\r\n          }}\r\n          onMouseLeave={(e) => {\r\n            onMouseEnter(e);\r\n            setisHovered(false);\r\n          }}\r\n          // dragBoundFunc={(e) => {\r\n          //   // console.log(e);\r\n          //   // return { x: x, y: y };\r\n          //   // return null;\r\n          //   return absolutePosition;\r\n          //   // return { x: 0, y: 0 };\r\n          // }}\r\n          // shadowColor={\"black\"}\r\n          // shadowBlur={15}\r\n          // shadowOffsetX={0}\r\n          // shadowOffsetY={0}\r\n          // shadowOpacity={0.2}\r\n          fillLinearGradientStartPoint={{ x: 0, y: 0 }}\r\n          fillLinearGradientEndPoint={{ x: w, y: h }}\r\n          fillLinearGradientColorStops={gradient}\r\n          onDragMove={(e) => {\r\n            onDragMove(e);\r\n          }}\r\n          draggable={draggable}\r\n          stroke={isHovered ? \"white\" : \"black\"}\r\n          strokeWidth={isHovered ? 2 : 2}\r\n        />\r\n        <Rect\r\n          // fillLinearGradientStartPoint={{ x: w, y: h }}\r\n          // // fillLinearGradientStartPoint={startPoint}\r\n          // fillLinearGradientEndPoint={{ x: 0, y: 0 }}\r\n          // fillLinearGradientColorStops={[0, \"red\", 0.5, \"black\", 1, \"green\"]}\r\n          // stroke={isHovered ? \"white\" : \"red\"}\r\n          strokeWidth={2}\r\n          // width={actualWidth}\r\n          width={w}\r\n          height={h}\r\n          x={0}\r\n          y={0}\r\n        />\r\n        {renderGhost()}\r\n      </Group>\r\n    );\r\n  }\r\n);\r\nconst getGradient = (tags: string[]): (string | number)[] => {\r\n  let stop1 = \"blue\";\r\n  let stop2 = \"yellow\";\r\n\r\n  if (tags.includes(\"MR\")) {\r\n    stop1 = \"#3023AE\";\r\n    stop2 = \"#53A0FD\";\r\n    // console.log(\"HAD AN MR\");\r\n  }\r\n  if (tags.includes(\"LR\")) {\r\n    stop1 = \"#8c34eb\";\r\n    stop2 = \"#d034eb\";\r\n  }\r\n  if (tags.includes(\"LR\")) {\r\n    stop1 = \"#ebd510\";\r\n    stop2 = \"#eb8110\";\r\n  }\r\n  if (tags.includes(\"MIX\")) {\r\n    stop1 = \"#60eb10\";\r\n    stop2 = \"#2a10eb\";\r\n  }\r\n\r\n  return [0, stop1, 0.5, stop2, 1, stop1];\r\n};\r\nexport default SamplePath;\r\n","import SampleData from \"@classes/SampleData\";\r\nimport canvasConfig from \"@static/canvasConfig\";\r\nimport theme from \"@static/theme\";\r\nimport { Actions } from \"easy-peasy\";\r\nimport Konva from \"konva\";\r\nimport { Group } from \"konva/lib/Group\";\r\nimport { LayerConfig } from \"konva/lib/Layer\";\r\nimport { KonvaEventObject } from \"konva/lib/Node\";\r\nimport { Shape } from \"konva/lib/Shape\";\r\nimport { PathConfig } from \"konva/lib/shapes/Path\";\r\nimport React, { useState, useEffect, useMemo, useRef } from \"react\";\r\nimport { Layer } from \"react-konva\";\r\nimport { AppMode, CanvasModel } from \"../../Canvas\";\r\nimport SamplePath, { EnrichedSample } from \"../SamplePath\";\r\n\r\ninterface SampleLayerProperties\r\n  extends Pick<\r\n    Actions<CanvasModel>,\r\n    | \"setSampleToClone\"\r\n    | \"setIsDragging\"\r\n    | \"addToCurrentCollection\"\r\n    | \"setIsDragging\"\r\n    | \"setHoveredId\"\r\n    | \"setPlayingSample\"\r\n  > {\r\n  appMode: AppMode;\r\n  samples: SampleData[];\r\n  sampleToClone: Konva.Path | undefined;\r\n  //   sampleToClone: Shape<PathConfig> | undefined;\r\n  dragLayerRef: React.MutableRefObject<any>;\r\n  sampleTrayGroupRef: React.MutableRefObject<Group>;\r\n  stageY: number;\r\n}\r\n\r\nconst SampleLayer = ({\r\n  appMode,\r\n  samples,\r\n  sampleTrayGroupRef,\r\n  setSampleToClone,\r\n  addToCurrentCollection,\r\n  setIsDragging,\r\n  dragLayerRef,\r\n  sampleToClone,\r\n  setHoveredId,\r\n  setPlayingSample,\r\n  stageY,\r\n}: SampleLayerProperties): JSX.Element => {\r\n  useEffect(() => {\r\n    console.log(samples);\r\n  }, [samples]);\r\n\r\n  const sampleLayerRef = useRef(null);\r\n\r\n  const sampleLayerProps = {\r\n    x: canvasConfig.sampleContainerWidth + 20,\r\n    y: stageY,\r\n    ref: sampleLayerRef,\r\n  };\r\n\r\n  useEffect(() => {\r\n    if (sampleLayerRef.current) {\r\n      if (appMode === \"editor\" || appMode === \"viewer\") {\r\n        sampleLayerRef.current.to({\r\n          opacity: 0,\r\n          duration: 0.1,\r\n        });\r\n      } else {\r\n        if (appMode === \"samples\") {\r\n          sampleLayerRef.current.to({\r\n            opacity: 1,\r\n            duration: 0.1,\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }, [appMode]);\r\n\r\n  const onRectMouseDown = (e: KonvaEventObject<MouseEvent>): void => {\r\n    console.log(\"DOING ON RECT MOUSE DOWN\");\r\n  };\r\n\r\n  const onRectMouseUp = (e: KonvaEventObject<MouseEvent>): void => {\r\n    console.log(samples.filter((s) => s.filename === e.target.attrs.id)[0]);\r\n    setPlayingSample(\r\n      samples.filter((s) => s.filename === e.target.attrs.id)[0]\r\n    );\r\n  };\r\n\r\n  const toEnriched = (samples: SampleData[]): EnrichedSample[] => {\r\n    return samples.map((sample) => {\r\n      const onMouseDown = onRectMouseDown;\r\n      const onDragStart = (e: KonvaEventObject<DragEvent>) => {\r\n        setSampleToClone(e.target as Konva.Path);\r\n        e.target.moveTo(dragLayerRef.current);\r\n        console.log(e.target);\r\n      };\r\n\r\n      const onDragEnd = (e: KonvaEventObject<DragEvent>) => {\r\n        console.log(\"GOT DRAG END AT CANVAS\");\r\n        setIsDragging(false);\r\n        // setIsDragging(false);\r\n        if (sampleTrayGroupRef.current) {\r\n          if (\r\n            intersect(\r\n              e.target.getClientRect(),\r\n              sampleTrayGroupRef.current.getClientRect()\r\n            )\r\n          ) {\r\n            addToCurrentCollection(sampleToClone.attrs.id);\r\n          }\r\n          if (sampleToClone && sampleTrayGroupRef.current) {\r\n            sampleTrayGroupRef.current.children[0].setAttr(\"fill\", \"red\");\r\n            sampleToClone.moveTo(sampleLayerRef.current);\r\n          }\r\n        }\r\n        sampleTrayGroupRef.current.children[0].setAttr(\r\n          \"fill\",\r\n          theme.transparent\r\n        );\r\n        addToCurrentCollection(e.target.attrs.id);\r\n      };\r\n\r\n      const onMouseEnter = (e: KonvaEventObject<MouseEvent>) =>\r\n        setHoveredId(e.target.attrs.id);\r\n      const onDragMove = (e: KonvaEventObject<DragEvent>) => {\r\n        if (sampleTrayGroupRef.current) {\r\n          if (\r\n            intersect(\r\n              e.target.getClientRect(),\r\n              sampleTrayGroupRef.current.getClientRect()\r\n            )\r\n          ) {\r\n            sampleTrayGroupRef.current.children[0].setAttr(\r\n              \"fill\",\r\n              theme.secondaryHover\r\n            );\r\n            console.log(\"INTERSECTED WITH TRAY\");\r\n          } else {\r\n            sampleTrayGroupRef.current.children[0].setAttr(\r\n              \"fill\",\r\n              theme.transparent\r\n            );\r\n            // setRectFill(theme.transparent);\r\n            console.log(\"NO INTERSECTION\");\r\n          }\r\n        }\r\n      };\r\n      const onMouseUp = onRectMouseUp;\r\n\r\n      const fill = theme.secondary;\r\n      // const fill = \"green\";\r\n      const draggable = true;\r\n\r\n      return {\r\n        ...sample,\r\n        fill,\r\n        draggable,\r\n        onDragMove,\r\n        onDragStart,\r\n        onDragEnd,\r\n        onMouseEnter,\r\n        onMouseDown,\r\n        onMouseUp,\r\n      };\r\n    });\r\n  };\r\n\r\n  const drawSamples = (): JSX.Element[] => {\r\n    if (enriched[0].fit) {\r\n      return enriched.map((sample) => {\r\n        return <SamplePath key={sample.id} sample={sample} />;\r\n      });\r\n    }\r\n  };\r\n  const enriched = useMemo(() => {\r\n    console.log(samples);\r\n    return toEnriched(samples);\r\n  }, [samples]);\r\n\r\n  return <Layer {...sampleLayerProps}>{drawSamples()}</Layer>;\r\n};\r\n\r\nexport default SampleLayer;\r\n\r\n// const SampleLayer = \"fff\";\r\n// export default SampleLayer;\r\n\r\nfunction intersect(r1: any, r2: any) {\r\n  return !(\r\n    r2.x > r1.x + r1.width ||\r\n    r2.x + r2.width < r1.x ||\r\n    r2.y > r1.y + r1.height ||\r\n    r2.y + r2.height < r1.y\r\n  );\r\n}\r\n","import React, { useState, useEffect, useRef } from \"react\";\r\nimport { Circle, Group, Image, Layer, Rect } from \"react-konva\";\r\nimport Kosima from \"@classes/Kosima\";\r\nimport useImage from \"use-image\";\r\nimport theme from \"@static/theme\";\r\nimport { mapRange } from \"@utils\";\r\nimport { group } from \"console\";\r\nimport Konva from \"konva\";\r\nimport { ActionCreator, Actions } from \"easy-peasy\";\r\nimport { AppMode, CanvasModel } from \"../../Canvas\";\r\nimport canvasConfig from \"@static/canvasConfig\";\r\n\r\nconst WidgetsLayer = ({\r\n  widgetContainerRef,\r\n  appMode,\r\n}: {\r\n  appMode: AppMode;\r\n  widgetContainerRef: React.MutableRefObject<Konva.Group>;\r\n}): JSX.Element => {\r\n  const timeLineRef = useRef(null);\r\n\r\n  useEffect(() => {\r\n    if (widgetContainerRef.current) {\r\n      if (appMode === \"samples\" || appMode === \"viewer\") {\r\n        widgetContainerRef.current.to({\r\n          opacity: 0,\r\n          duration: 0.1,\r\n        });\r\n        timeLineRef.current.to({\r\n          opacity: 0,\r\n          duration: 0.1,\r\n        });\r\n      } else {\r\n        if (appMode === \"editor\") {\r\n          widgetContainerRef.current.to({\r\n            opacity: 1,\r\n            duration: 0.1,\r\n          });\r\n        }\r\n        if (appMode === \"editor\") {\r\n          timeLineRef.current.to({\r\n            opacity: 1,\r\n            duration: 0.1,\r\n          });\r\n        }\r\n      }\r\n    }\r\n  }, [appMode]);\r\n\r\n  const widgets = () => {\r\n    const widgCount = 4;\r\n    const arr = Array.from(Array(widgCount).keys());\r\n    const widgWidth = canvasConfig.widgetWidth;\r\n    const widgHeight = canvasConfig.widgetHeight;\r\n    const widgFill = theme.stroke;\r\n    // const widgFill = \"red\";\r\n    const groupX = (window.innerWidth - arr.length * widgWidth) / 2;\r\n    const groupY = (window.innerHeight - widgHeight) / 2;\r\n    const trackHeight = 80;\r\n    const trackGroupY = groupY - (50 + trackHeight);\r\n    const borderRectProps = {\r\n      fill: theme.secondary,\r\n      width: widgCount * widgWidth,\r\n      height: 2,\r\n    };\r\n\r\n    return (\r\n      <>\r\n        <Group x={groupX} y={trackGroupY} ref={timeLineRef}>\r\n          <Rect x={0} y={0} {...borderRectProps} />\r\n          <Rect x={0} y={trackHeight} {...borderRectProps} />\r\n        </Group>\r\n        <Group x={groupX} y={groupY} ref={widgetContainerRef}>\r\n          {arr.map((a, i) => {\r\n            const rectX = i * widgWidth;\r\n            return (\r\n              <Rect\r\n                key={i}\r\n                x={rectX}\r\n                fill={widgFill}\r\n                width={widgWidth}\r\n                height={widgHeight}\r\n                stroke={theme.secondary}\r\n                cornerRadius={theme.borderRadius}\r\n              ></Rect>\r\n            );\r\n          })}\r\n        </Group>\r\n      </>\r\n    );\r\n  };\r\n\r\n  return <>{widgets()}</>;\r\n};\r\n\r\nexport default WidgetsLayer;\r\n","import theme from \"@static/theme\";\r\nimport React, { useState, useEffect, useRef } from \"react\";\r\nimport ReactDOM from \"react-dom\";\r\nimport \"@css/DialogBox.scss\";\r\nimport classNames from \"classnames\";\r\nimport { useOnClickOutside } from \"@hooks\";\r\nimport { AppMode } from \"../Canvas\";\r\n\r\nconst Navigation = ({\r\n  appMode,\r\n  setAppMode,\r\n}: {\r\n  appMode: AppMode;\r\n  setAppMode: (mode: AppMode) => void;\r\n}): JSX.Element => {\r\n  const widthPercent = 25;\r\n  const leftPercent = 50 - widthPercent / 2;\r\n\r\n  const containerStyle = {\r\n    width: \"fit-content\",\r\n    height: \"1em\",\r\n    display: \"flex\",\r\n    // backgroundColor: theme.secondary,\r\n    // backgroundColor: theme.secondary,\r\n    borderRadius: theme.borderRadius,\r\n    position: \"absolute\",\r\n    // left: `${leftPercent}%`,\r\n    right: 0,\r\n    top: 0,\r\n    overflow: \"hidden\",\r\n    color: theme.textDark,\r\n    padding: \"1em\",\r\n    alignItems: \"center\",\r\n    margin: \"0.5em\",\r\n  } as React.CSSProperties;\r\n\r\n  return ReactDOM.createPortal(\r\n    <div style={containerStyle}>\r\n      {/* <div>nav1</div> */}\r\n      <NavItem setAppMode={setAppMode} appMode={appMode} />\r\n    </div>,\r\n    document.getElementById(\"navigation\") as HTMLDivElement\r\n  );\r\n};\r\n\r\nconst NavItem = ({\r\n  appMode,\r\n  setAppMode,\r\n}: {\r\n  appMode: AppMode;\r\n  setAppMode: (mode: AppMode) => void;\r\n}): JSX.Element => {\r\n  const navItemStyle = {\r\n    width: \"2em\",\r\n    height: \"2em\",\r\n    backgroundColor: theme.secondary,\r\n    borderRadius: \"50%\",\r\n  } as React.CSSProperties;\r\n  return (\r\n    <div\r\n      style={navItemStyle}\r\n      onClick={(e) => {\r\n        if (appMode !== \"viewer\") {\r\n          setAppMode(\"viewer\");\r\n        } else {\r\n          setAppMode(\"editor\");\r\n        }\r\n      }}\r\n    ></div>\r\n  );\r\n};\r\n\r\nexport default Navigation;\r\n","import appConfig from \"@static/appConfig\";\r\nimport CollectionContainer from \"./CanvasItems/CollectionContainer\";\r\nimport DialogBox from \"./DialogBox\";\r\nimport Konva from \"konva\";\r\nimport Kosima from \"@classes/Kosima\";\r\nimport KosimaRender from \"./CanvasItems/Layers/KosimaRender\";\r\nimport ReactPlayer from \"react-player\";\r\nimport SampleCollection from \"@classes/SampleCollection\";\r\nimport CollectionNav from \"./CanvasItems/CollectionNav\";\r\nimport SampleData from \"@classes/SampleData\";\r\nimport Tag from \"@classes/Tag\";\r\nimport tags from \"@static/tags\";\r\nimport theme from \"@static/theme\";\r\nimport { action, Action, computed, Computed, useLocalStore } from \"easy-peasy\";\r\nimport { Group, Layer, Rect, Stage } from \"react-konva\";\r\nimport { groupBy, mapRange } from \"@utils\";\r\nimport { KonvaEventObject } from \"konva/lib/Node\";\r\nimport { packSamples } from \"./rects\";\r\n// import { useDraggable } from \"@dnd-kit/core\";\r\nimport { useStoreState } from \"@hooks\";\r\nimport React, {\r\n  MutableRefObject,\r\n  useRef,\r\n  useState,\r\n  useMemo,\r\n  useEffect,\r\n} from \"react\";\r\nimport TagsLayer from \"./CanvasItems/Layers/TagsLayer\";\r\nimport canvasConfig from \"@static/canvasConfig\";\r\nimport { useKeyboardShortcut } from \"crooks\";\r\nimport SampleLayer from \"./CanvasItems/Layers/SampleLayer\";\r\nimport WidgetsLayer from \"./CanvasItems/Layers/WidgetsLayer\";\r\nimport Navigation from \"./CanvasItems/Navigation\";\r\n\r\nexport type AppMode = \"editor\" | \"samples\" | \"viewer\";\r\n\r\nexport interface CanvasModel {\r\n  activeCollection: SampleCollection;\r\n  activeSamples: Computed<CanvasModel, SampleData[]>;\r\n  addTag: Action<CanvasModel, string>;\r\n  addToCurrentCollection: Action<CanvasModel, string>;\r\n  allTags: Tag[];\r\n  appMode: AppMode;\r\n  availableTags: Computed<CanvasModel, Tag[]>;\r\n  draggingId: string;\r\n  hoveredId: string;\r\n  isDragging: boolean;\r\n  kosima: Kosima;\r\n  packedSamples: SampleData[];\r\n  playingSample: SampleData | undefined;\r\n  popOverOpen: boolean;\r\n  removeTag: Action<CanvasModel, string>;\r\n  sampleCollections: SampleCollection[];\r\n  sampleToClone: Konva.Path | undefined;\r\n  // sampleToClone: Shape<PathConfig> | undefined;\r\n  selectedTags: string[];\r\n  setActiveCollection: Action<CanvasModel, string>;\r\n  setAppMode: Action<CanvasModel, AppMode>;\r\n  setDraggingId: Action<CanvasModel, string>;\r\n  setHoveredId: Action<CanvasModel, string>;\r\n  setIsDragging: Action<CanvasModel, boolean>;\r\n  setPlayingSample: Action<CanvasModel, SampleData>;\r\n  setPopOverOpen: Action<CanvasModel, boolean>;\r\n  setSampleToClone: Action<CanvasModel, Konva.Path>;\r\n  // setSampleToClone: Action<CanvasModel, Shape<PathConfig>>;\r\n  setStageHeight: Action<CanvasModel, number>;\r\n  setStageY: Action<CanvasModel, number>;\r\n  setViewHeight: Action<CanvasModel, number>;\r\n  stageHeight: number;\r\n  stageY: number;\r\n  viewHeight: number;\r\n}\r\n// type CanvasState = StateMapper<_Pick<CanvasModel, _FilterKeys<CanvasModel, ActionTypes, \"default\">>>\r\n\r\nconst Canvas = ({ activeTags }: { activeTags: string[] }): JSX.Element => {\r\n  const samples = useStoreState((state) => state.samplesModel.samples);\r\n  const stageContainerRef = useRef<HTMLDivElement>();\r\n\r\n  interface SampleFit {\r\n    packed: SampleData[] | undefined;\r\n    rows: number | undefined;\r\n  }\r\n  const sampleLayerWidth = window.innerWidth / 3;\r\n  const packedSamples: SampleFit = useMemo(() => {\r\n    let packedRects = samples;\r\n    if (activeTags.length > 0) {\r\n      packedRects = packedRects.filter((r) =>\r\n        activeTags.every((t) => r.tags.includes(t))\r\n      );\r\n      console.log(packedRects);\r\n    }\r\n    packedRects = packSamples(packedRects, sampleLayerWidth, 5000).filter(\r\n      (s) => s.fit\r\n    );\r\n    let rows = 0;\r\n    if (packedRects[0]?.fit) {\r\n      const fits = samples.map((s) => s.fit).filter((f) => f);\r\n      const rowMap = groupBy(fits, \"y\");\r\n      rows = rowMap.size;\r\n    }\r\n    return {\r\n      packed: packedRects as SampleData[],\r\n      rows: rows,\r\n    } as SampleFit;\r\n  }, [samples, activeTags]);\r\n\r\n  const allTags = useMemo(() => {\r\n    let allTags = packedSamples.packed.map((s) => s.tags);\r\n    let flatTags = allTags.reduce(function (prev, next) {\r\n      return prev.concat(next);\r\n    });\r\n    let map = new Map();\r\n\r\n    tags.map((tag) => {\r\n      if (!map.has(tag)) {\r\n        map.set(tag, getNumMatches(flatTags, tag));\r\n      }\r\n    });\r\n    const finalTags = tags.map((t) => {\r\n      // console.log(map.get(t));\r\n      return new Tag(t, map.get(t));\r\n    });\r\n    console.log(flatTags);\r\n    console.log(finalTags);\r\n    return finalTags;\r\n  }, [packedSamples]);\r\n  // const availableTags = tags.map()\r\n  const sampleCollections = Array.from(Array(10).keys()).map(\r\n    (n, i) => new SampleCollection([], `Sample_Collection_${i}`)\r\n  );\r\n\r\n  const defaultCollection1 = new SampleCollection(\r\n    samples.slice(1, 6),\r\n    \"collection 1\"\r\n  );\r\n  const defaultCollection2 = new SampleCollection(\r\n    samples.slice(13, 19),\r\n    \"collection 2\"\r\n  );\r\n  const defaultCollection3 = new SampleCollection([], \"collection 3\");\r\n  const defaultCollection4 = new SampleCollection([], \"collection 4\");\r\n  const defaultCollection5 = new SampleCollection([], \"collection 5\");\r\n\r\n  const [state, actions] = useLocalStore<CanvasModel>(\r\n    () => ({\r\n      allTags: allTags,\r\n      appMode: canvasConfig.startMode,\r\n      // defaultCollections: [defaultCollection1, defaultCollection2, defaultCollection3, defaultCollection4, defaultCollection5],\r\n      sampleCollections: [\r\n        defaultCollection1,\r\n        defaultCollection2,\r\n        defaultCollection3,\r\n        defaultCollection4,\r\n        defaultCollection5,\r\n      ],\r\n      // sampleCollections: sampleCollections,\r\n      activeCollection: sampleCollections[0],\r\n      addToCurrentCollection: action((state, toAddId) => {\r\n        console.log(`ADDING ${toAddId} TO CURRENT COLLECTION`);\r\n        const toAdd = state.activeSamples.filter((s) => s.id === toAddId)[0];\r\n        state.activeCollection.samples.push(\r\n          state.activeSamples.filter((s) => s.id === toAddId)[0]\r\n        );\r\n      }),\r\n      sampleToClone: undefined,\r\n      setSampleToClone: action((state, toClone) => {\r\n        state.sampleToClone = toClone;\r\n      }),\r\n      setActiveCollection: action((state, collectionName) => {\r\n        state.activeCollection = state.sampleCollections.filter(\r\n          (c) => c.name === collectionName\r\n        )[0];\r\n      }),\r\n      availableTags: computed(\r\n        [(state) => state.activeSamples],\r\n        (activeSamples) => {\r\n          let allTags = activeSamples.map((s) => s.tags);\r\n          let flatTags = allTags.reduce(function (prev, next) {\r\n            return prev.concat(next);\r\n          });\r\n          let map = new Map();\r\n\r\n          tags.map((tag) => {\r\n            if (!map.has(tag)) {\r\n              map.set(tag, getNumMatches(flatTags, tag));\r\n            }\r\n          });\r\n          const finalTags = tags.map((t) => {\r\n            return new Tag(t, map.get(t));\r\n          });\r\n          return finalTags;\r\n        }\r\n      ),\r\n      selectedTags: [],\r\n      addTag: action((state, tagToAdd) => {\r\n        state.selectedTags.push(tagToAdd);\r\n      }),\r\n      removeTag: action((state, tagToRemove) => {\r\n        state.selectedTags = state.selectedTags.filter(\r\n          (t) => t !== tagToRemove\r\n        );\r\n      }),\r\n      kosima: new Kosima(),\r\n      hoveredId: \"\",\r\n      playingSample: undefined,\r\n      isDragging: false,\r\n      draggingId: \"\",\r\n      packedSamples: packedSamples.packed,\r\n      popOverOpen: false,\r\n      setPopOverOpen: action((state, open) => {\r\n        state.popOverOpen = open;\r\n      }),\r\n      activeSamples: computed(\r\n        [(state) => state.packedSamples, (state) => state.selectedTags],\r\n        (packedSamples, activeTags) => {\r\n          const active = packedSamples.filter((sample) =>\r\n            activeTags.every((t) => sample.tags.includes(t))\r\n          );\r\n          return packSamples(active, sampleLayerWidth, 5000);\r\n        }\r\n      ),\r\n      stageY: 0,\r\n      viewHeight: stageContainerRef.current?.getBoundingClientRect().height,\r\n      stageHeight: packedSamples.rows * appConfig.sampleHeight,\r\n      setStageHeight: action((state, height) => {\r\n        state.stageHeight = height;\r\n      }),\r\n      setViewHeight: action((state, height) => {\r\n        state.viewHeight = height;\r\n      }),\r\n      setStageY: action((state, y) => {\r\n        // console.log(y);\r\n        console.log(`view height ${state.viewHeight}`);\r\n        console.log(state.stageY);\r\n        const max = 0 - (state.stageHeight - state.viewHeight);\r\n        if (y > 0) {\r\n          console.log(y);\r\n          if (state.stageY < 0) {\r\n            console.log(\"doing first\");\r\n            state.stageY = Math.min(state.stageY + y, 0);\r\n            console.log(state.stageY);\r\n          }\r\n        } else {\r\n          if (state.stageY > max) {\r\n            console.log(state.stageY);\r\n            state.stageY += y;\r\n          }\r\n        }\r\n        console.log(state.stageHeight);\r\n      }),\r\n      setAppMode: action((state, mode) => {\r\n        state.appMode = mode;\r\n      }),\r\n      setIsDragging: action((state, isDragging) => {\r\n        state.isDragging = isDragging;\r\n      }),\r\n      setDraggingId: action((state, draggingId) => {\r\n        state.draggingId = draggingId;\r\n      }),\r\n      setHoveredId: action((state, hoveredId) => {\r\n        state.hoveredId = hoveredId;\r\n      }),\r\n      setPlayingSample: action((state, playingId) => {\r\n        state.playingSample = playingId;\r\n      }),\r\n    }),\r\n    [packedSamples, samples],\r\n    () => ({ devTools: false })\r\n  );\r\n  // const test = state.sampleToClone\r\n  const stageProps = {\r\n    width: window.innerWidth,\r\n    height: state.viewHeight,\r\n    onWheel: (e: KonvaEventObject<WheelEvent>) => {\r\n      console.log(e);\r\n      e.evt.preventDefault();\r\n      actions.setStageY(e.evt.deltaY);\r\n    },\r\n  };\r\n\r\n  const test = {\r\n    one: \"yes\",\r\n    two: \"no\",\r\n  };\r\n  const [currentSample, setCurrentRect] = useState<Konva.Path | null>(null);\r\n\r\n  const stageNodeRef = useRef<Konva.Stage>(null);\r\n  useEffect(() => {\r\n    actions.setViewHeight(\r\n      stageContainerRef.current?.getBoundingClientRect().height\r\n    );\r\n    stageNodeRef.current.container().style.backgroundColor = theme.primary;\r\n  }, [currentSample]);\r\n\r\n  useKeyboardShortcut({\r\n    keyCode: 32, //f\r\n    action: () => {\r\n      if (state.appMode === \"editor\") {\r\n        actions.setAppMode(\"samples\");\r\n      } else {\r\n        actions.setAppMode(\"editor\");\r\n      }\r\n    },\r\n    disabled: false, // This key is not required\r\n  });\r\n\r\n  const draggingRef = useRef<Konva.Path>(null);\r\n  const sampleTrayGroupRef = useRef<Konva.Group>(null);\r\n  const dragLayerRef = useRef(null);\r\n  const widgetContainerRef = useRef(null);\r\n\r\n  const containerStyle = {\r\n    // border: \"1px solid red\",\r\n    height: \"100%\",\r\n    width: \"100%\",\r\n  } as React.CSSProperties;\r\n\r\n  const containerHeight = window.innerHeight - 100;\r\n  let sampleTrayGroupY = (window.innerHeight - containerHeight) / 2;\r\n\r\n  useEffect(() => {\r\n    console.log(state.appMode);\r\n    if (widgetContainerRef.current) {\r\n      if (widgetContainerRef.current && state.appMode === \"editor\") {\r\n        const targY = widgetContainerRef.current.y();\r\n        const targX = widgetContainerRef.current.x();\r\n        const targHeight = widgetContainerRef.current.height();\r\n        sampleTrayGroupRef.current.to({\r\n          x: targX,\r\n          y: targY,\r\n          opacity: 1,\r\n        });\r\n        sampleTrayGroupRef.current.children[0].to({\r\n          height: canvasConfig.widgetHeight,\r\n          width: canvasConfig.widgetWidth,\r\n        });\r\n      } else if (widgetContainerRef.current && state.appMode === \"viewer\") {\r\n        sampleTrayGroupRef.current.to({\r\n          opacity: 0,\r\n          duration: 0.1,\r\n        });\r\n      } else {\r\n        sampleTrayGroupY = (window.innerHeight - containerHeight) / 2;\r\n        sampleTrayGroupRef.current.to({\r\n          x: canvasConfig.sampleCollectionGroupX,\r\n          y: (window.innerHeight - containerHeight) / 2,\r\n          opacity: 1,\r\n        });\r\n        sampleTrayGroupRef.current.children[0].to({\r\n          height: canvasConfig.sampleCollectionRectHeight,\r\n          width: canvasConfig.widgetWidth,\r\n        });\r\n      }\r\n    }\r\n  }, [state.appMode]);\r\n\r\n  return (\r\n    <>\r\n      <div\r\n        style={containerStyle}\r\n        ref={stageContainerRef}\r\n        className={\"outer-tray\"}\r\n      >\r\n        <DialogBox\r\n          open={state.popOverOpen}\r\n          setOpen={(val) => actions.setPopOverOpen(val)}\r\n        />\r\n        {state.playingSample ? (\r\n          <ReactPlayer\r\n            playing={true}\r\n            height={0}\r\n            width={0}\r\n            progressInterval={1}\r\n            onProgress={({ played, playedSeconds, loaded, loadedSeconds }) => {\r\n              currentSample?.fill(\"white\");\r\n              console.log(state.playingSample);\r\n            }}\r\n            url={state.playingSample?.src}\r\n          />\r\n        ) : (\r\n          <></>\r\n        )}\r\n        <Navigation\r\n          setAppMode={(mode) => actions.setAppMode(mode)}\r\n          appMode={state.appMode}\r\n        />\r\n        <Stage {...stageProps} ref={stageNodeRef}>\r\n          <Layer\r\n            ref={dragLayerRef}\r\n            onDragStart={(e) => {\r\n              state.sampleToClone.moveTo(dragLayerRef.current);\r\n              // toClone.moveTo(dragLayerRef.current);\r\n            }}\r\n            onDragEnd={(e) => {\r\n              console.log(e.target);\r\n              console.log(sampleTrayGroupRef);\r\n              // console.log(toClone);\r\n            }}\r\n            onDragMove={(e) => {\r\n              if (state.sampleToClone && sampleTrayGroupRef.current) {\r\n                if (\r\n                  intersect(\r\n                    draggingRef.current.getClientRect(),\r\n                    sampleTrayGroupRef.current.getClientRect()\r\n                  )\r\n                ) {\r\n                  sampleTrayGroupRef.current.getChildren()[0].attrs.fill =\r\n                    theme.secondaryHover;\r\n                  console.log(\"INTERSECTED WITH TRAY\");\r\n                } else {\r\n                  sampleTrayGroupRef.current.getChildren()[0].attrs.fill =\r\n                    theme.primaryInactive;\r\n                  console.log(\"NO INTERSECTION\");\r\n                }\r\n              }\r\n            }}\r\n          ></Layer>\r\n          <Layer>\r\n            <WidgetsLayer\r\n              widgetContainerRef={widgetContainerRef}\r\n              appMode={state.appMode}\r\n            />\r\n            <CollectionNav\r\n              sampleCollections={state.sampleCollections}\r\n              onMouseUp={(e: KonvaEventObject<MouseEvent>) => {\r\n                actions.setActiveCollection(e.target.attrs.id);\r\n              }}\r\n              activeCollection={state.activeCollection.name}\r\n            />\r\n            <Group\r\n              ref={sampleTrayGroupRef}\r\n              height={containerHeight}\r\n              y={sampleTrayGroupY}\r\n              x={canvasConfig.sampleCollectionGroupX}\r\n            >\r\n              <CollectionContainer\r\n                sampleCollection={state.activeCollection}\r\n                appMode={state.appMode}\r\n              />\r\n            </Group>\r\n          </Layer>\r\n          <SampleLayer\r\n            appMode={state.appMode}\r\n            samples={state.activeSamples}\r\n            sampleTrayGroupRef={sampleTrayGroupRef}\r\n            setSampleToClone={actions.setSampleToClone}\r\n            addToCurrentCollection={actions.addToCurrentCollection}\r\n            setIsDragging={actions.setIsDragging}\r\n            dragLayerRef={dragLayerRef}\r\n            sampleToClone={state.sampleToClone as Konva.Path}\r\n            setHoveredId={actions.setHoveredId}\r\n            setPlayingSample={actions.setPlayingSample}\r\n            stageY={state.stageY}\r\n          />\r\n          <TagsLayer\r\n            appMode={state.appMode}\r\n            tags={state.availableTags}\r\n            selectedTags={state.selectedTags}\r\n            removeTag={actions.removeTag}\r\n            addTag={actions.addTag}\r\n          />\r\n          <KosimaRender\r\n            kosima={state.kosima}\r\n            setPopOverOpen={actions.setPopOverOpen}\r\n          />\r\n        </Stage>\r\n      </div>\r\n    </>\r\n  );\r\n};\r\n\r\nexport default Canvas;\r\n\r\nfunction getNumMatches(array: any[], valToFind: string): number {\r\n  let numMatches = 0;\r\n  for (let i = 0, j = array.length; i < j; i += 1) {\r\n    if (array[i] === valToFind) {\r\n      numMatches += 1;\r\n    }\r\n  }\r\n  return numMatches;\r\n}\r\n\r\nfunction intersect(r1: any, r2: any): boolean {\r\n  return !(\r\n    r2.x > r1.x + r1.width ||\r\n    r2.x + r2.width < r1.x ||\r\n    r2.y > r1.y + r1.height ||\r\n    r2.y + r2.height < r1.y\r\n  );\r\n}\r\n\r\n// const dIndex = (1 / tags.length) * i * 2 * Math.PI;\r\n// const radius = 300;\r\n// let xPos = window.innerWidth - radius - 100;\r\n// // let xPos = window.innerWidth / 2;\r\n// let yPos = window.innerHeight / 2;\r\n// const xSin = -0.5 + Math.sin(dIndex);\r\n// const yCos = -0.5 + Math.cos(dIndex);\r\n\r\n// xPos += xSin * radius;\r\n// yPos += yCos * radius;\r\n// xPos += radius / 2;\r\n// yPos += radius / 2;\r\n","import \"@css/SampleTray.scss\";\r\n\r\nimport {\r\n  Action,\r\n  Thunk,\r\n  ThunkOn,\r\n  action,\r\n  thunk,\r\n  thunkOn,\r\n  useLocalStore,\r\n} from \"easy-peasy\";\r\nimport React, { FC, useEffect, useRef, useState } from \"react\";\r\n\r\nimport CloseButton from \"./CloseButton/CloseButton\";\r\nimport Heading from \"@components/UI/Heading\";\r\nimport IconButton from \"@components/UI/IconButton\";\r\nimport OverlayScrollbars from \"overlayscrollbars\";\r\nimport { OverlayScrollbarsComponent } from \"overlayscrollbars-react\";\r\nimport { Pane } from \"evergreen-ui\";\r\nimport Section from \"../UI/Section\";\r\nimport TagBar from \"./TagBar/TagBar\";\r\nimport classNames from \"classnames\";\r\nimport Canvas from \"./NewSampleTray/Canvas\";\r\n\r\n// import {useToggle} from \"@withvoid/melting-pot\"\r\n\r\nexport interface SampleTrayModel {\r\n  tags: string[];\r\n  addTag: Action<SampleTrayModel, string>;\r\n  removeTag: Action<SampleTrayModel, string>;\r\n}\r\n\r\nconst SampleTray = ({ active }: { active: boolean }): JSX.Element => {\r\n  const [state, actions] = useLocalStore<SampleTrayModel>(() => ({\r\n    tags: [] as string[],\r\n    addTag: action((_state, tag) => {\r\n      _state.tags.push(tag);\r\n    }),\r\n    removeTag: action((_state, tag) => {\r\n      _state.tags = _state.tags.filter((t: string) => t !== tag);\r\n    }),\r\n  }));\r\n\r\n  // const osComponentRef1 = React.createRef<OverlayScrollbarsComponent>();\r\n\r\n  const sampleTrayClass = classNames(\"sample-tray-container\", {\r\n    \"sample-tray-hidden\": active,\r\n  });\r\n\r\n  const containerRef = useRef<HTMLDivElement | undefined>();\r\n  const [tagFilter, setTagFilter] = useState(\"none\");\r\n\r\n  useEffect(() => {\r\n    console.log(`setting tray filter to ${tagFilter}`);\r\n    // console.log(tagFilter);\r\n  }, [tagFilter]);\r\n\r\n  return (\r\n    <Section className={sampleTrayClass}>\r\n      <Section\r\n        column={true}\r\n        backgroundColor=\"white\"\r\n        className={\"sample-tray-inner-container\"}\r\n      >\r\n        <Canvas activeTags={state.tags} />\r\n      </Section>\r\n    </Section>\r\n  );\r\n};\r\n\r\nexport default SampleTray;\r\n","export enum DropCategory{\r\n    SampleTraySample,\r\n    EDITOR,\r\n    PLACEHOLDER,\r\n    IFRAME,\r\n}\r\n\r\nexport enum DragSource {\r\n    SAMPLE_TRAY\r\n}\r\n  \r\nexport enum InteractionType {\r\n    ACTIVE = \"ACTIVE\",\r\n    STATIC = \"STATIC\",\r\n  }\r\n  export enum AppMode {\r\n    DISPLAY = \"DISPLAY\",\r\n    EDIT = \"EDIT\",\r\n    CYCLE = \"CYCLE\",\r\n  }\r\n\r\nexport enum Composition{\r\n  BACH_MOVEMENT_1 = \"BACH_MOVEMENT_1\",\r\n  BACH_MOVEMENT_2 = \"BACH_MOVEMENT_2\",\r\n  BACH_MOVEMENT_3 = \"BACH_MOVEMENT_3A\",\r\n  BACH_MOVEMENT_4 = \"BACH_MOVEMENT_4\",\r\n  BARTOK_MOVEMENT_1 = \"BARTOK_MOVEMENT_1\", \r\n  BARTOK_MOVEMENT_2 = \"BARTOK_MOVEMENT_2\",\r\n  YSAE_MOVEMENT_1 = \"YSAE_MOVEMENT_1\",\r\n}","import SampleTray from \"@components/SampleTray/SampleTray\";\r\nimport React, { useState, useEffect } from \"react\";\r\n\r\nconst Instrument = (): JSX.Element => {\r\n  return (\r\n    <div className=\"App\">\r\n      {/* <Editor isSampleTrayActive={isSampleTrayActive} /> */}\r\n      <SampleTray active={false} />\r\n    </div>\r\n  );\r\n};\r\n\r\nexport default Instrument;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { Route, BrowserRouter as Router, Switch, Link } from \"react-router-dom\";\r\nconst Home = (): JSX.Element => {\r\n  const cotainerStyle = {\r\n    // width: \"100%\",\r\n    display: \"flex\",\r\n    height: \"100vh\",\r\n    width: \"100vw\",\r\n    alignItems: \"center\",\r\n    justifyContent: \"center\",\r\n    flexDirection: \"column\",\r\n  } as React.CSSProperties;\r\n\r\n  const paragraphStyle = {\r\n    maxWidth: \"80ch\",\r\n  } as React.CSSProperties;\r\n\r\n  const imageStyle = {\r\n    maxWidth: \"3em\",\r\n  } as React.CSSProperties;\r\n\r\n  const headerStyle = {\r\n    fontSize: \"4em\",\r\n  } as React.CSSProperties;\r\n\r\n  return (\r\n    <section style={cotainerStyle}>\r\n      <h1 style={headerStyle}>Seisolo.io</h1>\r\n      <div>\r\n        <p style={paragraphStyle}>\r\n          SeiSolo.io is a multimedia web installation exploring classical and\r\n          electronic music, aiming to create a unique and accessible way of\r\n          engaging with both. It features a recorded solo violin recital, five\r\n          commissioned remixes of the recital repertoire, and a web-based\r\n          software for users to remix on their own.\r\n        </p>\r\n        <Link to=\"/app\">\r\n          <img\r\n            style={imageStyle}\r\n            src={`${process.env.PUBLIC_URL}/MVNT Logo 1.svg`}\r\n          ></img>\r\n        </Link>\r\n      </div>\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Home;\r\n\r\n// const NavItem = ({src, text, link}:{src: string, text: string, link?: string}): JSX.Element =>{\r\n\r\n//   return(\r\n//     <img src = {}></img>\r\n//     <div>hello</div>\r\n//   )\r\n// }\r\n","import \"@css/App.css\";\n\nimport React, { useEffect, useState } from \"react\";\nimport { useStoreActions, useToggle } from \"@hooks\";\nimport { useKeyboardShortcut } from \"crooks\";\nimport { Route, BrowserRouter as Router, Switch, Link } from \"react-router-dom\";\nimport Instrument from \"./pages/Instrument\";\nimport Home from \"./pages/Home\";\n\nconst App = (): JSX.Element => {\n  const fetchCardDataGoogleSheetThunk = useStoreActions(\n    (actions) => actions.googleSheetsModel.fetchAppGoogleSheet\n  );\n  const processCompositions = useStoreActions(\n    (actions) => actions.compositionsModel.processCompositions\n  );\n  const fetchCompositionSheet = useStoreActions(\n    (actions) => actions.googleSheetsModel.fetchCompositionsSheet\n  );\n  const fetchSamples = useStoreActions(\n    (actions) => actions.googleSheetsModel.fetchSamplesSheet\n  );\n  const [isSampleTrayActive, toggleSampleTrayIsActive] = useToggle(false);\n\n  useKeyboardShortcut({\n    keyCode: 70, //f\n    action: () => {\n      toggleSampleTrayIsActive();\n    },\n    disabled: false, // This key is not required\n  });\n\n  useEffect(() => {\n    fetchCardDataGoogleSheetThunk();\n    processCompositions();\n    fetchCompositionSheet();\n    fetchSamples();\n  }, [fetchCardDataGoogleSheetThunk]);\n\n  return (\n    <Router>\n      <Route path=\"/app\" component={Instrument} />\n      <Route path=\"/\" exact component={Home} />\n    </Router>\n  );\n};\n\nexport default App;\n","import { ReportHandler } from 'web-vitals';\n\nconst reportWebVitals = (onPerfEntry?: ReportHandler) => {\n  if (onPerfEntry && onPerfEntry instanceof Function) {\n    import('web-vitals').then(({ getCLS, getFID, getFCP, getLCP, getTTFB }) => {\n      getCLS(onPerfEntry);\n      getFID(onPerfEntry);\n      getFCP(onPerfEntry);\n      getLCP(onPerfEntry);\n      getTTFB(onPerfEntry);\n    });\n  }\n};\n\nexport default reportWebVitals;\n","enum IFrameLoadError {\r\n  CROSS_ORIGIN = \"CROSS_ORIGIN\",\r\n}\r\n\r\nenum IFrameLoadWarning {\r\n  MALFORMED_URL = \"MALFORMED_URL\",\r\n}\r\n\r\nclass IFrameValidator {\r\n  url!: string;\r\n  errors!: IFrameLoadError[];\r\n  warnings!: IFrameLoadWarning[];\r\n  constructor(url: string) {\r\n    this.errors = [];\r\n    this.warnings = [];\r\n    this.url = url;\r\n  }\r\n  validate(event: React.SyntheticEvent<HTMLIFrameElement, Event>): void {\r\n    const xoCheckArray = checkForXO(event);\r\n    console.log(xoCheckArray);\r\n    this.errors.push(...xoCheckArray);\r\n    console.log(this.errors);\r\n    const malformedUrlCheckArray = validURL(this.url);\r\n    this.warnings.push(...malformedUrlCheckArray);\r\n    console.log(malformedUrlCheckArray);\r\n  }\r\n  isValid(): boolean {\r\n    return this.errors.length == 0;\r\n  }\r\n  errorMessages(): string[] {\r\n    let errors: string[] = [];\r\n    this.errors.map((e) => {\r\n      switch (e) {\r\n        case IFrameLoadError.CROSS_ORIGIN:\r\n          errors.push(\r\n            `Blocked a frame with origin ${this.url}; from accessing a cross-origin frame.`\r\n          );\r\n          break;\r\n        default:\r\n          console.log(\"error did not match an error enum\");\r\n      }\r\n    });\r\n    return errors;\r\n  }\r\n}\r\n\r\nexport default IFrameValidator;\r\n\r\nfunction checkForXO(\r\n  event: React.SyntheticEvent<HTMLIFrameElement, Event>\r\n): IFrameLoadError[] {\r\n  let errorsArray: IFrameLoadError[] = [];\r\n  const test = event.target as HTMLIFrameElement;\r\n//   console.log(test.contentDocument);\r\n//   console.log(test.contentWindow);\r\n  try { \r\n      \r\n    test.contentWindow?.name;\r\n  } catch (e) {\r\n    if (e.message.includes(\"cross-origin\")) {\r\n      console.log(e.message);\r\n      errorsArray.push(IFrameLoadError.CROSS_ORIGIN);\r\n    } else return [];\r\n  }\r\n  return errorsArray;\r\n}\r\n\r\nfunction validURL(str: string): IFrameLoadWarning[] {\r\n  let warningsArray = [];\r\n  const pattern = new RegExp(\r\n    \"^(https?:\\\\/\\\\/)?\" + // protocol\r\n      \"((([a-z\\\\d]([a-z\\\\d-]*[a-z\\\\d])*)\\\\.)+[a-z]{2,}|\" + // domain name\r\n      \"((\\\\d{1,3}\\\\.){3}\\\\d{1,3}))\" + // OR ip (v4) address\r\n      \"(\\\\:\\\\d+)?(\\\\/[-a-z\\\\d%_.~+]*)*\" + // port and path\r\n      \"(\\\\?[;&a-z\\\\d%_.~+=-]*)?\" + // query string\r\n      \"(\\\\#[-a-z\\\\d_]*)?$\",\r\n    \"i\"\r\n  ); // fragment locator\r\n  if (!pattern.test(str)) {\r\n    warningsArray.push(IFrameLoadWarning.MALFORMED_URL);\r\n  }\r\n  return warningsArray;\r\n}\r\n","import type RawCardRow from \"@interfaces/RawCardRow\";\r\nimport { InteractionType } from \"@enums\";\r\nimport IFrameValidator from \"../IFrameValidator\";\r\nexport default class CardData {\r\n  readonly src: string;\r\n  readonly title: string;\r\n  readonly added?: Date;\r\n  readonly sourceId: string;\r\n  readonly author: string;\r\n  readonly interaction: InteractionType;\r\n  // error: undefined | \r\n  validator!: IFrameValidator;\r\n  isActive!: boolean;\r\n  failed!: boolean;\r\n  // instanceId!: string;\r\n\r\n  constructor(row: RawCardRow) {\r\n    this.src = row.src;\r\n    this.title = row.title;\r\n    this.added = new Date(row.added);\r\n    this.sourceId = row.src;\r\n    this.author = row.author;\r\n    this.interaction =\r\n      InteractionType[row.interaction as keyof typeof InteractionType];\r\n    this.isActive = false;\r\n    this.validator = new IFrameValidator(this.src)\r\n    this.failed = false; \r\n    // this.error = undefined;\r\n  }\r\n  setActive(b: boolean): void {\r\n    this.isActive = b;\r\n  }\r\n  fail(){\r\n    console.log(this.validator.errors);\r\n    this.failed = true; \r\n    // this.error = \r\n  }\r\n}\r\n","import { Layout, Layouts } from \"react-grid-layout\";\r\n// const availableHandles: ResizeHandle[] = [\r\n//   \"s\",\r\n//   \"w\",\r\n//   \"e\",\r\n//   \"n\",\r\n//   \"sw\",\r\n//   \"nw\",\r\n//   \"se\",\r\n//   \"ne\",\r\n// ];\r\nconst defaultGridLayoutArray: Layout[] = [\r\n  {\r\n    i: \"https://seisolo.io\",\r\n    x: 0,\r\n    y: 0,\r\n    w: 1,\r\n    h: 1,\r\n    static: false,\r\n  },\r\n  {\r\n    i: \"https://seisolo2.io\",\r\n    x: 1,\r\n    y: 0,\r\n    w: 1,\r\n    h: 1,\r\n    static: false,\r\n  },\r\n  {\r\n    i: \"https://seisolo3.io\",\r\n    x: 2,\r\n    y: 0,\r\n    w: 1,\r\n    h: 1,\r\n    static: false,\r\n  },\r\n  {\r\n    i: \"https://seisolo4.io\",\r\n    x: 3,\r\n    y: 0,\r\n    w: 1,\r\n    h: 1,\r\n    static: false,\r\n  },\r\n];\r\n\r\n// const defaultGridLayoutArr: Layout[] = [\r\n//   { i: \"clock\", x: 0, y: 0, w: 2, h: 1, static: true },\r\n//   {\r\n//     i: \"b2d9c003-8edc-4304-a05e-d78b9e8f782f_1\",\r\n//     x: 0,\r\n//     y: 1,\r\n//     w: 1,\r\n//     h: 1,\r\n//     static: true,\r\n//   },\r\n//   {\r\n//     i: \"b2d9c003-8edc-4304-a05e-d78b9e8f782f_3\",\r\n//     x: 2,\r\n//     y: 0,\r\n//     w: 1,\r\n//     h: 1,\r\n//     minW: 2,\r\n//     maxW: 4,\r\n//   },\r\n//   { i: \"b2d9c003-8edc-4304-a05e-d78b9e8f782f_3\", x: 2, y: 0, w: 1, h: 1 },\r\n//   { i: \"b2d9c003-8edc-4304-a05e-d78b9e8f782f_3\", x: 3, y: 0, w: 1, h: 1 },\r\n//   { i: \"b2d9c003-8edc-4304-a05e-d78b9e8f782f_5\", x: 0, y: 1, w: 1, h: 1 },\r\n//   { i: \"b2d9c003-8edc-4304-a05e-d78b9e8f782f_6\", x: 1, y: 1, w: 1, h: 1 },\r\n//   { i: \"b2d9c003-8edc-4304-a05e-d78b9e8f782f_7\", x: 2, y: 1, w: 1, h: 1 },\r\n//   { i: \"b2d9c003-8edc-4304-a05e-d78b9e8f782f_8\", x: 3, y: 1, w: 1, h: 1 },\r\n//   { i: \"b2d9c003-8edc-4304-a05e-d78b9e8f782f_9\", x: 0, y: 3, w: 1, h: 1 },\r\n//   { i: \"b2d9c003-8edc-4304-a05e-d78b9e8f782f_10\", x: 1, y: 3, w: 1, h: 1 },\r\n// ];\r\n\r\nconst defaultLayouts: Layouts = {\r\n  lg: defaultGridLayoutArray,\r\n  md: defaultGridLayoutArray,\r\n  sm: defaultGridLayoutArray,\r\n  xs: defaultGridLayoutArray,\r\n  xxs: defaultGridLayoutArray,\r\n};\r\n\r\nconsole.log(JSON.stringify(defaultLayouts));\r\nexport default defaultLayouts;\r\n","import { Layouts } from \"react-grid-layout\";\r\n/**\r\n *\r\n */\r\nexport default class History {\r\n  events!: Layouts[];\r\n  currentStep!: number;\r\n\r\n  constructor() {\r\n    const emptyLayoutsArray: Layouts[] = [];\r\n    this.events = emptyLayoutsArray;\r\n    this.currentStep = 0;\r\n  }\r\n  addEditEvent(event: Layouts) {\r\n    this.currentStep += 1;\r\n    this.events.push(event);\r\n  }\r\n  undo(): Layouts {\r\n    console.log(this.currentStep);\r\n    this.currentStep -= 1;\r\n    return this.events[this.currentStep];\r\n  }\r\n  redo(): Layouts {\r\n    console.log(this.currentStep);\r\n    this.currentStep += 1;\r\n    return this.events[this.currentStep];\r\n  }\r\n}\r\n","import {\r\n  action,\r\n  thunk,\r\n  Thunk,\r\n  Action,\r\n  ActionOn,\r\n  thunkOn,\r\n  ThunkOn,\r\n  debug,\r\n  actionOn,\r\n} from \"easy-peasy\";\r\nimport CardData from \"@classes/CardData\";\r\nimport type RawCardRow from \"../interfaces/RawCardRow\";\r\nimport { Layouts } from \"react-grid-layout\";\r\nimport defaultGridLayout from \"../static/defaultLayouts\";\r\nimport { AppMode } from \"../enums\";\r\nimport History from \"@classes/History\";\r\nimport { StoreModel } from \"./index\";\r\n/**\r\n * Core app model\r\n * @param\r\n */\r\nexport interface AppDataModel {\r\n  //state\r\n  availableCards: CardData[];\r\n  activeCards: CardData[];\r\n  currentLayout: Layouts;\r\n  appMode: AppMode;\r\n  history: History;\r\n  // localStorageLayouts: any[];\r\n\r\n  //requests\r\n  // fetchGoogleSheet: Thunk<AppDataModel>;\r\n\r\n  //loaders\r\n  // loadLocalLayouts: Action<AppDataModel>;\r\n\r\n  //listeners\r\n  onCardSheetLoadSuccess: ActionOn<AppDataModel, StoreModel>;\r\n  onSwapCardContent: ThunkOn<AppDataModel, never, StoreModel>;\r\n  onSetActiveLayout: ThunkOn<AppDataModel, never, StoreModel>;\r\n  //managers\r\n  manageViewModeChange: Thunk<AppDataModel, AppMode>;\r\n  toggleViewMode: Thunk<AppDataModel, never>;\r\n  //simple setters\r\n  setAppMode: Action<AppDataModel, AppMode>;\r\n  setCurrentLayout: Action<AppDataModel, Layouts>;\r\n  setActiveCards: Action<AppDataModel, CardData[]>;\r\n  setAvailableCards: Action<AppDataModel, CardData[]>;\r\n  registerCardLoadFailure: Thunk<AppDataModel, CardData, never, StoreModel>\r\n  //listeners\r\n  onUndoHistory: ThunkOn<AppDataModel, never, StoreModel>;\r\n  onRedoHistory: ThunkOn<AppDataModel, never, StoreModel>;\r\n\r\n  //clear\r\n  // clearLocalLayouts: Action<AppDataModel>;\r\n\r\n  //local storage\r\n  // saveLayoutLocal: Thunk<AppDataModel>;\r\n}\r\n\r\nconst appModel: AppDataModel = {\r\n  //state\r\n  availableCards: [],\r\n  activeCards: [],\r\n  currentLayout: defaultGridLayout,\r\n  appMode: AppMode.DISPLAY,\r\n  history: new History(),\r\n  // localStorageLayouts: [],\r\n\r\n  //managers\r\n  /**Control side effects for altering the view state of the app, and dispatch a setter for the state */\r\n  manageViewModeChange: thunk((actions, viewModeEnum) => {\r\n    console.log(viewModeEnum);\r\n    actions.setAppMode(viewModeEnum);\r\n    switch (viewModeEnum) {\r\n      case AppMode.EDIT:\r\n        break;\r\n      case AppMode.DISPLAY:\r\n        break;\r\n      case AppMode.CYCLE:\r\n        break;\r\n      default:\r\n        console.log(\"reached default in set view mode thunk\");\r\n    }\r\n  }),\r\n  toggleViewMode: thunk((actions, _, { getState }) => {\r\n    console.log(\"toggling view mod \");\r\n\r\n    switch (getState().appMode) {\r\n      case AppMode.EDIT:\r\n        actions.setAppMode(AppMode.DISPLAY);\r\n        break;\r\n      case AppMode.DISPLAY:\r\n        actions.setAppMode(AppMode.EDIT);\r\n        break;\r\n      case AppMode.CYCLE:\r\n        break;\r\n      default:\r\n        console.log(\"reached default in set view mode thunk\");\r\n    }\r\n    console.log(getState().appMode);\r\n  }),\r\n  setCurrentLayout: action((state, layoutArray) => {\r\n    state.currentLayout = layoutArray;\r\n  }),\r\n  setAvailableCards: action((state, cardDataArray) => {\r\n    console.log(\"setting available cards\");\r\n    state.availableCards = cardDataArray;\r\n  }),\r\n  setActiveCards: action((state, cardDataArray) => {\r\n    console.log(\"setting active cards\");\r\n    console.log(cardDataArray);\r\n    state.activeCards = cardDataArray;\r\n  }),\r\n  setAppMode: action((state, viewModeEnum) => {\r\n    console.log(\"setting view mode\");\r\n    state.appMode = viewModeEnum;\r\n  }),\r\n\r\n  //listeners\r\n  onCardSheetLoadSuccess: actionOn(\r\n    // targetResolver:\r\n    (actions, storeActions) =>\r\n      storeActions.googleSheetsModel.setAppGoogleSheetData,\r\n    // handler:\r\n    (state, target) => {\r\n      // console.log(\"got on card sheet load success\");\r\n      const cardRowsArray = target.payload.getSheetRows(0);\r\n      const rawCardRowsArray = cardRowsArray.map((row) => {\r\n        return {\r\n          src: row.src,\r\n          title: row.title,\r\n          added: row.added,\r\n          sourceid: row.sourceid,\r\n          author: row.author,\r\n          interaction: row.interaction,\r\n        } as RawCardRow;\r\n      });\r\n      const cards = rawCardRowsArray.map((c: RawCardRow) => new CardData(c));\r\n      console.log(cards);\r\n      state.availableCards = cards;\r\n      console.log(debug(state.availableCards));\r\n    }\r\n  ),\r\n\r\n  onSetActiveLayout: thunkOn(\r\n    (actions, storeActions) => storeActions.layoutsModel.setActiveLayout,\r\n    async (actions, layout, { getState }) => {\r\n      // console.log(\"listened for setActiveLayout at app_model\");\r\n      //if a card source is in the active layout, then it must be active\r\n      // const sources = layout.payload.sources();\r\n      // console.log(sources);\r\n      const activeSources = layout.payload\r\n        .sources()\r\n        .filter((s) => s !== \"clock\");\r\n\r\n      const availableCardsUpdated = getState().availableCards.map((card) => {\r\n        if (activeSources.includes(card.sourceId)) {\r\n          card.setActive(true);\r\n        } else {\r\n          card.setActive(false);\r\n        }\r\n        return card;\r\n      });\r\n      const activeCards = getState().availableCards.filter((card) => {\r\n        return activeSources.includes(card.sourceId);\r\n      });\r\n      // console.log(availableCardsUpdated);\r\n      actions.setAvailableCards(availableCardsUpdated);\r\n      actions.setActiveCards(activeCards);\r\n      // console.log(activeCards);\r\n    }\r\n  ),\r\n  registerCardLoadFailure: thunk((actions, failedCard, { getState, getStoreState }) => {\r\n    console.log(\"Got card Register Load Failure at Layouts Model\");\r\n    console.log(failedCard);\r\n    const { activeCards } = getState();\r\n    const failedId = failedCard.sourceId;\r\n    let newCards = activeCards.map(c=>{\r\n      if (c.sourceId === failedId) {\r\n        console.log(\"found failed\");\r\n        c.fail();\r\n      }\r\n      return c\r\n    })\r\n    actions.setActiveCards(newCards);\r\n  }),\r\n  onSwapCardContent: thunkOn(\r\n    (actions, storeActions) => storeActions.layoutsModel.swapCardContent,\r\n    async (actions, payload, { getState }) => {\r\n      console.log(\"got swap card content\");\r\n      console.log(payload.payload);\r\n      console.log(getState().activeCards);\r\n      const newCards = getState().activeCards.map((c) => {\r\n        if (c.sourceId === payload.payload.targetId) {\r\n          const newSource = getState().availableCards.find(\r\n            (c) => c.sourceId === payload.payload.sourceId\r\n          );\r\n          console.log(newSource);\r\n          return newSource;\r\n        } else {\r\n          return c;\r\n        }\r\n      });\r\n      if (newCards) {\r\n        actions.setActiveCards(newCards as CardData[]);\r\n      }\r\n      console.log(debug(payload));\r\n    }\r\n  ),\r\n\r\n  onUndoHistory: thunkOn(\r\n    (actions, storeActions) => storeActions.historyModel.setCurrentHistory,\r\n    async (actions, payload) => {\r\n      console.log(\"got undo\");\r\n      console.log(payload.payload);\r\n      actions.setCurrentLayout(payload.payload);\r\n      console.log(debug(payload));\r\n    }\r\n  ),\r\n  onRedoHistory: thunkOn(\r\n    (actions, storeActions) => storeActions.historyModel.setCurrentHistory,\r\n    async (actions, payload) => {\r\n      console.log(\"got redo\");\r\n      console.log(payload.payload);\r\n      actions.setCurrentLayout(payload.payload);\r\n      console.log(debug(payload));\r\n    }\r\n  ),\r\n  //local storage\r\n  // clearLocalLayouts: action((state) => {\r\n  //   localStorage.clear();\r\n  //   state.localStorageLayouts = [];\r\n  // }),\r\n  // loadLocalLayouts: action((state) => {\r\n  //   const layouts: any = Object.keys(localStorage)\r\n  //     .filter((k) => k.startsWith(\"curLayout\"))\r\n  //     .map((k) => ({\r\n  //       name: k,\r\n  //       layout: JSON.parse(localStorage[k]) as Layout[],\r\n  //     }));\r\n  //   state.localStorageLayouts = layouts;\r\n  // }),\r\n  // saveLayoutLocal: thunk((actions, _, { getState }) => {\r\n  //   localStorage.setItem(\r\n  //     `curLayout_${localStorage.length}`,\r\n  //     JSON.stringify(getState().currentLayout)\r\n  //   );\r\n  //   actions.loadLocalLayouts();\r\n  // }),\r\n};\r\n\r\nexport default appModel;\r\n","import WaveformData from \"waveform-data\";\nimport SampleData from \"./SampleData\";\nimport SVGCatmullRomSpline from \"svg-catmull-rom-spline\";\nimport { mapRange } from \"@utils\";\n\nexport default class WaveFormBuilder {\n  generateSVG(original: SampleData): Promise<SampleData> {\n    console.log(original.src);\n    return this.getAudio(original.src)\n      .then((a) => {\n        // console.log(a);\n        // original.calculateDimensions(document.window.innerWidth)\n        const pathData = this.collectSamplePoints(a, original);\n        original.setPath(pathData);\n        // console.log(original.path);\n        return original;\n      })\n      .catch((e) => {\n        return original;\n      });\n  }\n  collectSamplePoints = (data: WaveformData, sample: SampleData) => {\n    const numberOfPoints = 10;\n    const duration = data.duration;\n    const trueWidth = 0;\n    const yOffset = 10;\n    const mapToMax = 40;\n    const mapToMin = 0;\n    const maxSampleLengthSeconds = 2.5;\n    const minSampleLengthSeconds = 0;\n    const minSvgViewBoxWidth = 100;\n    const maxSvgViewBoxWidth = 400;\n    const sampleDuration = data.duration;\n    const svgViewBoxWidth = mapRange(\n      sampleDuration,\n      minSampleLengthSeconds,\n      maxSampleLengthSeconds,\n      minSvgViewBoxWidth,\n      maxSvgViewBoxWidth\n      // maxSvgViewBoxWidth\n    );\n    console.log(sampleDuration);\n\n    const points: DataPoint[] = [];\n    for (let index = 0; index < numberOfPoints; index++) {\n      const currentTime = index * (1 / numberOfPoints) * duration;\n      const channel1 = data.channel(0);\n      const valueAtTime = data.at_time(currentTime);\n      const maxSampleVal = channel1.max_sample(valueAtTime);\n      // console.log(maxSampleVal);\n      const percentageComplete = index / numberOfPoints;\n      const xValue = percentageComplete * svgViewBoxWidth;\n\n      console.log(percentageComplete);\n\n      let yValue = mapRange(maxSampleVal, 0, 100, mapToMin, mapToMax);\n      yValue += yOffset;\n      // console.log(yValue);\n      // const xValue = Math.round(currentTime*200);\n      const timePointValue = { x: xValue, y: Math.round(yValue) };\n      points.push(timePointValue);\n      // console.log(`audio point value ${index} is ${timePointValue.x}, ${timePointValue.y}`)\n    }\n    // const testpoints = [[0, 0], [200, -200], [200, 0], [0, 200]];\n    const tolerance = 4;\n    const highestQuality = true;\n    // const attribute = SVGCatmullRomSpline.toPath(testpoints, tolerance, highestQuality);\n\n    //top line\n    const topPoints = points.map((p) => [p.x, p.y]);\n    //add a point between the top and bottom\n    topPoints.push([topPoints[topPoints.length - 1][0], 0]);\n\n    //reverse points to conenct\n\n    const reversePoints = points.map((p) => [p.x, trueWidth - p.y]).reverse();\n\n    const nextPointX = reversePoints[reversePoints.length - 1][0];\n    const nextPointY = topPoints[0][1];\n    const newPoint = [nextPointX, nextPointY];\n    reversePoints.push(newPoint);\n\n    const allPoints = [...topPoints, ...reversePoints];\n    const newTestedPoints = SVGCatmullRomSpline.toPath(\n      allPoints,\n      tolerance,\n      highestQuality\n    );\n\n    // console.log(newTestedPoints);\n    return newTestedPoints;\n    // return svgPath\n  };\n  data!: any[];\n  audioContext!: AudioContext;\n\n  constructor() {\n    this.data = [];\n    this.audioContext = new AudioContext();\n  }\n\n  getAudio = (url: string): Promise<WaveformData> => {\n    // const audioContext = new AudioContext();\n    return fetch(url)\n      .then((response) => response.arrayBuffer())\n      .then((buffer) => {\n        const options = {\n          audio_context: this.audioContext,\n          array_buffer: buffer,\n          scale: 128,\n        };\n\n        return new Promise((resolve, reject) => {\n          WaveformData.createFromAudio(options, (err, waveform) => {\n            if (err) {\n              console.error(`FAILED TO CREATE AUDIO FROM URL ${url}`);\n              reject(err);\n            } else {\n              resolve(waveform);\n            }\n          });\n        });\n      });\n  };\n}\n\ninterface DataPoint {\n  x: number;\n  y: number;\n}\n\nfunction catmullRom2bezier(points: DataPoint[]): DataPoint[] {\n  var result = [];\n  for (var i = 0; i < points.length - 1; i++) {\n    var p = [];\n\n    p.push({\n      x: points[Math.max(i - 1, 0)].x,\n      y: points[Math.max(i - 1, 0)].y,\n    });\n    p.push({\n      x: points[i].x,\n      y: points[i].y,\n    });\n    p.push({\n      x: points[i + 1].x,\n      y: points[i + 1].y,\n    });\n    p.push({\n      x: points[Math.min(i + 2, points.length - 1)].x,\n      y: points[Math.min(i + 2, points.length - 1)].y,\n    });\n\n    // Catmull-Rom to Cubic Bezier conversion matrix\n    //    0       1       0       0\n    //  -1/6      1      1/6      0\n    //    0      1/6      1     -1/6\n    //    0       0       1       0\n\n    var bp = [];\n    bp.push({\n      x: (-p[0].x + 6 * p[1].x + p[2].x) / 6,\n      y: (-p[0].y + 6 * p[1].y + p[2].y) / 6,\n    });\n    bp.push({\n      x: (p[1].x + 6 * p[2].x - p[3].x) / 6,\n      y: (p[1].y + 6 * p[2].y - p[3].y) / 6,\n    });\n    bp.push({\n      x: p[2].x,\n      y: p[2].y,\n    });\n    result.push(bp);\n  }\n\n  return result;\n}\n\nfunction makePath(points: DataPoint[]): string {\n  let result = \"M\" + points[0].x + \",\" + points[0].y + \" \";\n  const catmull = catmullRom2bezier(points);\n  for (const element of catmull) {\n    result +=\n      \"C\" +\n      element[0].x +\n      \",\" +\n      element[0].y +\n      \" \" +\n      element[1].x +\n      \",\" +\n      element[1].y +\n      \" \" +\n      element[2].x +\n      \",\" +\n      element[2].y +\n      \" \";\n  }\n  return result;\n}\n\nfunction generateSVG() {\n  var graph = [2, 2, 5, 8, 5, 4, 3, 9];\n  var points = [];\n  for (var i = 0; i < graph.length; i++) {\n    let newPoint = { x: i * 50 + 20, y: graph[i] * 40 * -1 + 400 };\n    console.log(newPoint);\n    points.push({ x: i * 50 + 20, y: graph[i] * 40 * -1 + 400 });\n  }\n  document.querySelector(\"#svg path\").setAttribute(\"d\", makePath(points));\n  for (var i = 0; i < points.length; i++) {\n    var circle = points[i];\n    var c = document.createElementNS(\"http://www.w3.org/2000/svg\", \"circle\");\n    c.setAttribute(\"cx\", circle.x);\n    c.setAttribute(\"cy\", circle.y);\n    c.setAttribute(\"r\", \"3\");\n    document.querySelector(\"#svg\").appendChild(c);\n  }\n}\n\n// window.onload = function () {\n//     var graph = [2, 2, 5, 8, 5, 4, 3, 9];\n//     var points = [];\n//     for (var i = 0; i < graph.length; i++) {\n//         let newPoint = {x: i * 50 + 20, y: graph[i] * 40 * -1 + 400};\n//         console.log(newPoint);\n//         points.push({x: i * 50 + 20, y: graph[i] * 40 * -1 + 400});\n//     }\n//     document.querySelector('#svg path').setAttribute('d', makePath(points));\n//     for (var i = 0; i < points.length; i++) {\n//         var circle = points[i];\n//         var c = document.createElementNS(\"http://www.w3.org/2000/svg\", \"circle\");\n//         c.setAttribute(\"cx\", circle.x);\n//         c.setAttribute(\"cy\", circle.y);\n//         c.setAttribute(\"r\", \"3\");\n//         document.querySelector('#svg').appendChild(c);\n//     }\n// };\n","import WaveformData from \"waveform-data\"\n\nexport type CompositionTitle = \"Bartok Movement 1\" | \"Bach Movement 1\" | \"Bach Movement 2\"\n\n\nclass CompositionData{\n    title!: CompositionTitle\n    url!: string;\n    waveFormData: WaveformData | undefined\n    constructor(title: CompositionTitle, url: string) {\n        this.title = title\n        this.waveFormData\n        this.url = url\n    }\n\n    buildWaveform(): Promise<WaveformData>{\n        return getAudio(this.url).then(d=>{\n          this.waveFormData = d\n          return new Promise((resolve, reject)=>{\n            resolve(d)\n          })\n        })\n    }\n\n}\n\nexport default CompositionData\n\n\nconst getAudio = (url: string): Promise<WaveformData>=>{\n    // const audioContext = new AudioContext();\n    const audioContext = new AudioContext();\n    return fetch(url)\n    .then(response => response.arrayBuffer())\n    .then(buffer => {\n      const options = {\n        audio_context: audioContext,\n        array_buffer: buffer,\n        scale: 128\n      };\n  \n      return new Promise((resolve, reject) => {\n        WaveformData.createFromAudio(options, (err, waveform) => {\n          if (err) {\n            reject(err);\n          }\n          else {\n            resolve(waveform);\n          }\n        });\n      });\n    })\n  }","import CompositionData from \"@classes/ðŸŽ»CompositionData\";\n\nconst genearteDefaultCompositions = (): CompositionData =>{\n    // const url = `${process.env.PUBLIC_URL}/`+\"RECORDINGS/Bach Mov 2 v2.wav\"\n    const url = `${process.env.PUBLIC_URL}/`+\"BACH2.mp3\"\n    const bachMovement1 = new CompositionData(\"Bach Movement 2\", url)\n    console.log(bachMovement1);\n    return bachMovement1\n}\n\nconst defaultCompositions: CompositionData[] = [genearteDefaultCompositions()]\n\nexport default defaultCompositions","\n\n\nimport { action, Action, thunk, Thunk, thunkOn, ThunkOn } from \"easy-peasy\";\nimport History from \"@classes/History\";\nimport { Layouts } from \"react-grid-layout\";\nimport WaveFormBuilder from \"@classes/WaveFormBuilder\";\nimport SampleData from \"@classes/SampleData\";\nimport placeHolderSamples from \"@static/placeHolderSamples\"\nimport { StoreModel } from \"model\";\nimport WaveformData from \"waveform-data\";\nimport CompositionData from \"@classes/ðŸŽ»CompositionData\";\nimport defaultCompositions from \"@static/defaultCompositions\";\nimport FileSaver from \"file-saver\"\nimport Papa from \"papaparse\"\nimport { RawCompositionRow } from \"@interfaces/RawCompositionRow\";\n\nexport interface CompositionsModel{\n    //state\n    compositions: CompositionData[],\n    //thunks\n    //simple setters\n    setCompositions: Action<CompositionsModel, CompositionData[]>\n    //proccessing\n    processCompositions: Thunk<CompositionsModel, never, StoreModel>\n    downloadAnalysis: Action<CompositionsModel>\n}\n\n\nconst compositionsModel: CompositionsModel = {\n    //state\n    compositions: defaultCompositions,\n    //processing\n    processCompositions: thunk((actions, _, {getState})=>{\n        console.log(\"processing compositions\")\n        const state = getState()\n        const { compositions: compositions }  = {...state}\n\n        console.log(compositions)\n        const processor = new WaveFormBuilder()\n\n        //TODO: ERROR HANDLING\n        const analysisResults = compositions.map(c=>processor.getAudio(c.url))\n        \n        // const waveformData = processor.getAudio()\n        // const processedCompositions = compositions.map(composition=>composition.buildWaveform());\n        Promise.allSettled(analysisResults).then(results=>{\n            const succesfulAnalaysisCompositions: CompositionData[] = [];\n            for (let index = 0; index < results.length; index++) {\n                const result = results[index];\n                const compClone = [...compositions]\n                const comp = compClone[index]   \n                console.log(result);\n                if (result.status == \"fulfilled\"){\n                    comp.waveFormData = result.value \n                    succesfulAnalaysisCompositions.push(comp)\n                }\n            }\n            console.log(\"SETTINGS COMPOSITOINS\");\n            console.log(succesfulAnalaysisCompositions);\n            actions.setCompositions(succesfulAnalaysisCompositions)\n            actions.downloadAnalysis()\n        })\n        // console.log(processedCompositions);\n    }),\n    //simple setters\n    setCompositions: action((state, samplesArray) => {\n        console.log(\"setting samples\")\n        state.compositions = samplesArray;\n        // state.tempLayout = layouts;\n      }),\n    downloadAnalysis: action((state)=>{\n        console.log(state.compositions[0].waveFormData.toJSON().data);\n        const rows: RawCompositionRow[] = state.compositions.map(c=>({title: c.title, url: c.url , data: JSON.stringify(c.waveFormData)}))\n        const csv = Papa.unparse(rows)\n        console.log(rows[0].data.length);\n        \n        var csvData = new Blob([csv], {type: 'text/csv;charset=utf-8;'});\n        // FileSaver.saveAs(csvData, \"test.csv\")\n    })\n}\n\nexport default compositionsModel\n\n","import type SheetId from \"../interfaces/SheetId\";\r\n\r\nconst cardDataSheetKey: SheetId = {\r\n  key: \"1eq33_1yJS6EZjqBvxWgL7nDP0OxC8bMdJJqU7Akp_3E\",\r\n  // key: \"1o-R04VC8cIbcmqM68q4ESguaaNYb-0jhoPNgEuKa0i4\",\r\n  sheet_number: 1,\r\n};\r\nexport default cardDataSheetKey;\r\n\r\n// 1o-R04VC8cIbcmqM68q4ESguaaNYb-0jhoPNgEuKa0i4\r\n// key: \"181P-SDszUOj_xn1HJ1DRrO8pG-LXyXNmINcznHeoK8k\",\r\n","import { ConsoleIcon } from \"evergreen-ui\";\r\nimport {\r\n  GoogleSpreadsheet,\r\n  GoogleSpreadsheetRow,\r\n  GoogleSpreadsheetWorksheet,\r\n} from \"google-spreadsheet\";\r\n\r\nexport default class GoogleSheetData {\r\n  title!: string;\r\n  sheetId!: string;\r\n  sheets!: GoogleSpreadsheetRow[][];\r\n\r\n  constructor(\r\n    title: string,\r\n    sheetId: string,\r\n    sheets: GoogleSpreadsheetRow[][]\r\n  ) {\r\n    this.title = title;\r\n    this.sheetId = sheetId;\r\n    this.sheets = sheets;\r\n  }\r\n  getSheetRows(sheetIndex: number): GoogleSpreadsheetRow[] {\r\n    return this.sheets[sheetIndex];\r\n  }\r\n  loadSheets(\r\n    sheetId: string,\r\n    apikey: string\r\n  ): Promise<Promise<GoogleSpreadsheetRow[]>[]> {\r\n    const document = new GoogleSpreadsheet(sheetId);\r\n    document.useApiKey(apikey);\r\n    const sheetPromiseArray: Promise<GoogleSpreadsheetRow[]>[] = [];\r\n    return document.loadInfo().then(() => {\r\n      document.sheetsByIndex.forEach((element) => {\r\n        const myTest = element.getRows();\r\n        console.log(myTest);\r\n        sheetPromiseArray.push(myTest);\r\n      });\r\n      return sheetPromiseArray;\r\n    });\r\n  }\r\n}\r\n","import { action, Action, thunk, Thunk } from \"easy-peasy\";\r\nimport type GoogleSheet from \"../interfaces/GoogleSheet\";\r\nimport type RawCardRow from \"../interfaces/RawCardRow\";\r\nimport type RawLayoutRow from \"../interfaces/RawLayoutRow\";\r\nimport cardDataSheetKey from \"@static/cardDataSheetKey\";\r\nimport layoutsGoogleSheetKey from \"@static/layoutsGoogleSheetKey\";\r\nimport GoogleSheetData from \"@classes/ðŸ“‹GoogleSheetData\";\r\nimport Papa, { ParseConfig } from \"papaparse\";\r\nimport { RawCompositionRow } from \"@interfaces/RawCompositionRow\";\r\nimport { ParagraphProps } from \"evergreen-ui\";\r\nimport RawSampleRow from \"@interfaces/RawSampleRow\";\r\nimport analyzeClips from '@static/analyzeClips';\r\n\r\ntype Result =\r\n  | { success: true; value: unknown }\r\n  | { success: false; error: Error };\r\n\r\nexport interface GoogleSheetsModel {\r\n  //state\r\n  compositionsSheet: GoogleSheetData | undefined;\r\n  appGoogleSheet: GoogleSheetData | undefined;\r\n  cardDataGoogleSheet: RawCardRow[] | null;\r\n  samplesSheet: RawSampleRow[];\r\n  // cardDataGoogleSheet: GoogleSheet<RawCardRow> | null;\r\n  layoutDataGoogleSheet: GoogleSheet<RawLayoutRow> | null;\r\n\r\n  //requests\r\n  fetchAppGoogleSheet: Thunk<GoogleSheetsModel>;\r\n  fetchCompositionsSheet: Thunk<GoogleSheetsModel>;\r\n  fetchSamplesSheet: Thunk<GoogleSheetsModel>;\r\n  // fetchLayoutDataGoogleSheet: Thunk<GoogleSheetsModel>;\r\n\r\n  //setters\r\n  setAppGoogleSheetData: Action<GoogleSheetsModel, GoogleSheetData>;\r\n  setCardDataGoogleSheet: Action<GoogleSheetsModel, RawCardRow[]>;\r\n  setCompositionsSheet: Action<GoogleSheetsModel, Papa.ParseResult<unknown>>;\r\n  setSamplesSheet: Action<GoogleSheetsModel, unknown[]>;\r\n  // setCardDataGoogleSheet: Action<GoogleSheetsModel, GoogleSheet<RawCardRow>>;\r\n  setLayoutDataGoogleSheet: Action<\r\n    GoogleSheetsModel,\r\n    GoogleSheet<RawLayoutRow>\r\n  >;\r\n}\r\n/**\r\n * Responsible for making requestst to google sheets. Other models must listen this model to intercept the sheet payload.\r\n * Also stores the fetch data purely for debugging purposes.\r\n */\r\n\r\nconst googleSheetsModel: GoogleSheetsModel = {\r\n  //state\r\n  layoutDataGoogleSheet: null,\r\n  cardDataGoogleSheet: null,\r\n  appGoogleSheet: undefined,\r\n  samplesSheet: [],\r\n  compositionsSheet: undefined,\r\n\r\n  //request\r\n  fetchCompositionsSheet: thunk(async (actions) => {\r\n    console.log(\"FETCHING COMPOSITIONS SHEET\");\r\n    const url  = publicSheetUrl(\"/TEST_ANALYSIS.csv\")\r\n    parseSheet(url, (r)=>{actions.setCompositionsSheet(r)})\r\n  }),\r\n  fetchSamplesSheet: thunk(async (actions) => {\r\n    console.log(\"Fetching Samples\");\r\n    if (analyzeClips){\r\n      console.log(\"USING UNPROCESSED SAMPLE SHEET\");\r\n      const url  = publicSheetUrl(\"/out_csv.csv\")\r\n      parseSheet(url, (r)=>{actions.setSamplesSheet(r.data)})\r\n    }\r\n    else {\r\n      console.log(\"USING PREPROCESSED SAMPLE SHEET\");\r\n      const url  = publicSheetUrl(\"/CLIPS_4.csv\")\r\n      parseSheet(url, (r)=>{actions.setSamplesSheet(r.data)})\r\n    }\r\n  }),\r\n  fetchAppGoogleSheet: thunk(async (actions) => {\r\n    GoogleSheetData.prototype\r\n      .loadSheets(\r\n        cardDataSheetKey.key,\r\n        process.env.REACT_APP_GCP_TOKEN as string\r\n      )\r\n      .then((response) => {\r\n        Promise.all(response).then((responseData) => {\r\n          const studentsGoogleSheet = new GoogleSheetData(\r\n            \"DSC App\",\r\n            cardDataSheetKey.key,\r\n            responseData\r\n          );\r\n          console.log(studentsGoogleSheet);\r\n          actions.setAppGoogleSheetData(studentsGoogleSheet);\r\n        });\r\n      });\r\n  }),\r\n  //Simple Setters\r\n  setAppGoogleSheetData: action((state, googleSheet) => {\r\n    state.appGoogleSheet = googleSheet;\r\n  }),\r\n  setCardDataGoogleSheet: action((state, sheet) => {\r\n    state.cardDataGoogleSheet = sheet;\r\n  }),\r\n  setLayoutDataGoogleSheet: action((state, sheet) => {\r\n    state.layoutDataGoogleSheet = sheet;\r\n  }),\r\n  setCompositionsSheet: action((state, compositionSheet) => {\r\n    compositionSheet.data = compositionSheet.data as RawCompositionRow[]\r\n  }),\r\n  setSamplesSheet: action((state, samplesSheet) => {\r\n    state.samplesSheet = samplesSheet as RawSampleRow[]\r\n  }),\r\n};\r\n\r\nexport default googleSheetsModel;\r\n\r\n\r\n\r\n// console.log(url);\r\n// Papa.parse(url, {\r\n//     download: true,\r\n//     header: true,\r\n//     complete: function(results) {\r\n//       console.log(results);\r\n//       actions.setSamplesSheet(results.data)\r\n//     }\r\n// });\r\n\r\nconst parseSheet = (url: string, complete: (results: Papa.ParseResult<unknown>)=>void) => {\r\n  Papa.parse(url, {\r\n    download: true,\r\n    header: true,\r\n    complete: function(results) {\r\n      console.log(results);\r\n      complete(results)\r\n    }})\r\n};\r\n\r\nconst publicSheetUrl = (file: string) =>{\r\n  if (!file.endsWith(\".csv\")){\r\n    console.error(\"Failed to load csv, wrong extension (not .csv)\")\r\n  }\r\n  return process.env.PUBLIC_URL+file;\r\n}\r\n","import { action, Action, thunk, Thunk, thunkOn, ThunkOn } from \"easy-peasy\";\r\nimport History from \"@classes/History\";\r\nimport { Layouts } from \"react-grid-layout\";\r\n\r\nexport interface HistoryModel {\r\n  history: History;\r\n  addEditHistory: Action<HistoryModel, Layouts>;\r\n  undoIt: Action<HistoryModel>;\r\n  redoIt: Action<HistoryModel>;\r\n  undoHistory: Thunk<HistoryModel>;\r\n  setCurrentHistory: Action<HistoryModel, Layouts>;\r\n  // onAddTodo: ThunkOn<HistoryModel, any, StoreModel>;\r\n}\r\nconst historyModel: HistoryModel = {\r\n  history: new History(),\r\n  undoHistory: thunk((actions, _, { getState }) => {\r\n    // console.log(payload);\r\n    actions.undoIt();\r\n    actions.setCurrentHistory(getState().history.undo());\r\n    // const newLayouts = state.history.undo();\r\n    // console.log(newLayouts);\r\n  }),\r\n  undoIt: action((state) => {\r\n    state.history.undo();\r\n    console.log(state.history.currentStep);\r\n    // console.log(payload);\r\n  }),\r\n  redoIt: action((state) => {\r\n    state.history.redo();\r\n    console.log(state.history.currentStep);\r\n    // console.log(payload);\r\n  }),\r\n  setCurrentHistory: action((state, payload) => {\r\n    console.log(payload);\r\n  }),\r\n  // undoHistory: action((state, layouts) => {\r\n  //   console.log(layouts);\r\n  //   const newLayouts = state.history.undo();\r\n  //   console.log(newLayouts);\r\n  // }),\r\n\r\n  // undoHistory: action((state, layouts) => {\r\n  //   console.log(layouts);\r\n  //   const newLayouts = state.history.undo();\r\n  //   console.log(newLayouts);\r\n  // }),\r\n  addEditHistory: action((state, layouts) => {\r\n    console.log(\"adding edit history\");\r\n    console.log(layouts);\r\n    const test = JSON.stringify(layouts);\r\n    console.log(test);\r\n    state.history.addEditEvent(layouts);\r\n  }),\r\n};\r\n\r\nexport default historyModel;\r\n","import { Layout, Layouts } from \"react-grid-layout\";\r\nimport type RawLayoutRow from \"../interfaces/RawLayoutRow\";\r\nimport type { CardSwapEvent, CardAddEvent } from \"../interfaces/CardEvents\";\r\nimport CardData from \"./CardData\";\r\n// import { Ok, Err, Result } from \"ts-results\";\r\nimport defaultLayouts from \"../static/defaultLayouts\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\nimport type { GridPosition } from \"../interfaces/GridPosition\";\r\n\r\n//TODO: Google form columns and layoutData fields should have the same capitilization\r\nexport default class LayoutData {\r\n  readonly title: string;\r\n  readonly author: string;\r\n  readonly added: Date;\r\n  readonly id: string;\r\n  layout: Layouts;\r\n  constructor(row: RawLayoutRow) {\r\n    this.id = row.title + \"_\" + row.timestamp;\r\n    this.title = row.title;\r\n    this.author = row.author;\r\n    //7/26/2021 14:38:57\r\n    //7/26/2021\r\n    this.added = new Date(row.timestamp.split(\" \")[0]);\r\n    const startLayout: Layouts = JSON.parse(row.layout);\r\n    this.layout = startLayout;\r\n  }\r\n  swapCard(swapInfo: CardSwapEvent): void {\r\n    for (const [k, v] of Object.entries(this.layout)) {\r\n      for (const [index, layoutValue] of v.entries()) {\r\n        if (layoutValue.i == swapInfo.targetId) {\r\n          v[index].i = swapInfo.sourceId;\r\n        }\r\n      }\r\n      this.layout[k] = v;\r\n    }\r\n  }\r\n  removeCard(toRemove: CardData): void {\r\n    console.log(this.layout);\r\n    for (const [k, v] of Object.entries(this.layout)) {\r\n      for (const [index, layoutValue] of v.entries()) {\r\n        // console.log(layoutVal);\r\n        this.layout[k] = v.filter((l) => l.i !== toRemove.sourceId);\r\n        // if (layoutVal.i == toRemove.sourceId) {\r\n        //   console.log(layoutVal);\r\n        // }\r\n      }\r\n    }\r\n  }\r\n  addCard(toAdd: CardData, pos: GridPosition): void {\r\n    console.log(\"ADDING CARD AT LAYOUT DATA\");\r\n    console.log(this.layout);\r\n    for (const [k, v] of Object.entries(this.layout)) {\r\n      const newItem: Layout = {\r\n        x: pos.x,\r\n        y: pos.y,\r\n        w: 1,\r\n        h: 1,\r\n        i: toAdd.sourceId,\r\n      };\r\n      this.layout[k].push(newItem);\r\n    }\r\n  }\r\n  failCard(toFail: CardData){\r\n    console.log(\"FAILING CARD AT LAYOUT DATA\");\r\n    // console.log()\r\n  }\r\n  setGridLayout(newGridLayout: Layouts): void {\r\n    console.log(newGridLayout);\r\n    this.layout = newGridLayout;\r\n  }\r\n  sources(): string[] {\r\n    const lg = Object.entries(this.layout)[0][1];\r\n    return lg.map((l: any) => l.i);\r\n  }\r\n}\r\n\r\nfunction findEmptyGridPositions(\r\n  layouts: Layout[],\r\n  rows: number,\r\n  cols: number\r\n): GridPosition[] {\r\n  const allGridSpots: GridPosition[] = [];\r\n  for (let y = 0; y < rows; y++) {\r\n    for (let x = 0; x < cols; x++) {\r\n      allGridSpots.push({ x: x, y: y });\r\n    }\r\n  }\r\n  const filledSpots = findFilledPositions(layouts);\r\n  const stringFilledSpots = new Set(\r\n    filledSpots.map((fs) => [fs.x, fs.y].toString())\r\n  );\r\n\r\n  return allGridSpots.filter(\r\n    (gs) => !stringFilledSpots.has([gs.x, gs.y].toString())\r\n  );\r\n}\r\n\r\nfunction findFilledPositions(layouts: Layout[]): GridPosition[] {\r\n  const takenSpots: GridPosition[] = [];\r\n  for (const l of layouts) {\r\n    takenSpots.push({ x: l.x, y: l.y });\r\n    for (let index = 1; index < l.w; index++) {\r\n      const fullSpotX: GridPosition = {\r\n        x: l.x + index,\r\n        y: l.y,\r\n      };\r\n      takenSpots.push(fullSpotX);\r\n    }\r\n    for (let index = 1; index < l.h; index++) {\r\n      const fullSpotY: GridPosition = {\r\n        x: l.x,\r\n        y: l.y + index,\r\n      };\r\n      takenSpots.push(fullSpotY);\r\n    }\r\n  }\r\n  return takenSpots;\r\n}\r\n\r\n// function parseLayout(\r\n//   data: string\r\n// ): Result<Layouts, \"failed to parse layoutJSON\"> {\r\n//   try {\r\n//     const layouts = JSON.parse(data);\r\n//     return Ok(layouts);\r\n//   } catch {\r\n//     return Err(\"failed to parse layoutJSON\");\r\n//   }\r\n// }\r\n\r\nfunction generateFilledLayout(\r\n  layout: Layout[],\r\n  emptyPosArray: GridPosition[]\r\n): Layouts {\r\n  const emptyCards = emptyPosArray.map((rr) => {\r\n    return {\r\n      x: rr.x,\r\n      y: rr.y,\r\n      w: 1,\r\n      h: 1,\r\n      i: `empty_card_${uuidv4()}`,\r\n      minW: 1,\r\n      maxW: 1,\r\n      minH: 1,\r\n      maxH: 1,\r\n      static: true,\r\n      isDraggable: false,\r\n      isResizable: false,\r\n      resizeHandles: [],\r\n    } as Layout;\r\n  });\r\n  const filled = layout.concat(emptyCards);\r\n  return {\r\n    lg: filled,\r\n    md: filled,\r\n    sm: filled,\r\n    xs: filled,\r\n    xxs: filled,\r\n  };\r\n}\r\n// function getCount(): Promise<Result<number, Error>> {\r\n//   return fetch(\"/index-count\")\r\n//     .then((res) => res.json())\r\n//     .then((body): Ok<number, Error> => ok(body[\"count\"]))\r\n//     .catch(() => err(new Error(\"Something when wrong while fetching count\")));\r\n// }\r\n\r\n// // To access the count, we'll first have to check if the calculation succeeded.\r\n// if (res.isOk()) {\r\n//   // Now we can access the value.\r\n//   console.log(\"Count is:\", res.value);\r\n// }\r\n\r\n// if (res.isErr()) {\r\n//   // Now we can access the error.\r\n//   console.error(\"Oh no, there was an error:\", res.error);\r\n// }\r\n\r\n// // https://dev.to/duunitori/mimicing-rust-s-result-type-in-typescript-3pn1\r\n// // type Result =\r\n// //   | { success: true; value: unknown }\r\n// //   | { success: false; error: Error };\r\n\r\n// export type Result<T, E> = Ok<T, E> | Err<T, E>;\r\n\r\n// export class Ok<T, E> {\r\n//   public constructor(public readonly value: T) {}\r\n\r\n//   public isOk(): this is Ok<T, E> {\r\n//     return true;\r\n//   }\r\n\r\n//   public isErr(): this is Err<T, E> {\r\n//     return false;\r\n//   }\r\n// }\r\n\r\n// export class Err<T, E> {\r\n//   public constructor(public readonly error: E) {}\r\n\r\n//   public isOk(): this is Ok<T, E> {\r\n//     return false;\r\n//   }\r\n\r\n//   public isErr(): this is Err<T, E> {\r\n//     return true;\r\n//   }\r\n// }\r\n\r\n// /**\r\n//  * Construct a new Ok result value.\r\n//  */\r\n// export const ok = <T, E>(value: T): Ok<T, E> => new Ok(value);\r\n\r\n// /**\r\n//  * Construct a new Err result value.\r\n//  */\r\n// export const err = <T, E>(error: E): Err<T, E> => new Err(error);\r\n","import {\r\n  action,\r\n  thunk,\r\n  Thunk,\r\n  Action,\r\n  thunkOn,\r\n  ThunkOn,\r\n  debug,\r\n} from \"easy-peasy\";\r\nimport CardData from \"@classes/CardData\";\r\nimport LayoutData from \"@classes/LayoutData\";\r\nimport { StoreModel } from \"./index\";\r\nimport { Layout, Layouts } from \"react-grid-layout\";\r\nimport { CardAddEvent, CardSwapEvent } from \"../interfaces/CardEvents\";\r\nimport defaultLayouts from \"../static/defaultLayouts\";\r\nimport { AppMode } from \"../enums\";\r\nimport RawCardRow from \"../interfaces/RawCardRow\";\r\nimport RawLayoutRow from \"../interfaces/RawLayoutRow\";\r\nimport IFrameValidator from \"../IFrameValidator\";\r\nimport defaultLayout from \"@static/defaultLayouts\" \r\nexport interface LayoutsModel {\r\n  //state\r\n  activeLayout: LayoutData | undefined;\r\n  externalLayouts: LayoutData[];\r\n  bufferLayout: Layouts;\r\n  tempLayout: Layouts;\r\n  //listeners\r\n  onSetAppGoogleSheetData: ThunkOn<LayoutsModel, never, StoreModel>;\r\n  onToggleViewModeListener: ThunkOn<LayoutsModel, never, StoreModel>;\r\n  //requests\r\n\r\n  //simple setters\r\n  setActiveLayout: Action<LayoutsModel, LayoutData>;\r\n  setExternalLayouts: Action<LayoutsModel, LayoutData[]>;\r\n  setBufferLayout: Action<LayoutsModel, Layouts>;\r\n  setTempLayout: Action<LayoutsModel, Layouts>;\r\n  updateLayout: Action<LayoutsModel, CardSwapEvent>;\r\n\r\n  // storeBufferLayout: Action<LayoutsModel>;\r\n\r\n  //update\r\n  swapCardContent: Thunk<LayoutsModel, CardSwapEvent, StoreModel>;\r\n  deleteCard: Thunk<LayoutsModel, CardData, StoreModel>;\r\n  addCard: Thunk<LayoutsModel, CardAddEvent, never, StoreModel>;\r\n  registerCardLoadFailure: Thunk<LayoutsModel, CardData, never, StoreModel>\r\n}\r\n\r\nconst layoutsModel: LayoutsModel = {\r\n  //state\r\n  activeLayout: undefined,\r\n  externalLayouts: [],\r\n  bufferLayout: defaultLayouts,\r\n  tempLayout: defaultLayouts,\r\n\r\n  //listeners\r\n  /**On setAppGoogleSheetData, create an array of LayoutData objects from the provided rows */\r\n  onSetAppGoogleSheetData: thunkOn(\r\n    (actions, storeActions) =>\r\n      storeActions.googleSheetsModel.setAppGoogleSheetData,\r\n    (actions, target) => {\r\n      //extract only the needed properties from the GoogleSheetRow\r\n      const rawLayoutRows = target.payload.getSheetRows(1).map((l) => {\r\n        return {\r\n          title: l.title,\r\n          author: l.author,\r\n          timestamp: l.timestamp,\r\n          layout: l.layout,\r\n          interaction: l.interaction,\r\n        } as RawLayoutRow;\r\n      });\r\n      const layouts = rawLayoutRows.map((l) => new LayoutData(l));\r\n      // const defaultLayout = layouts[0];\r\n      // const defaultLayout = defa\r\n      // layouts.\r\n      const dLayout = layouts[0];\r\n      dLayout.layout = defaultLayout;\r\n      actions.setActiveLayout(dLayout);\r\n      // const bufferLayout = layouts[0]\r\n      // if (defaultLayout) {\r\n      //   actions.setActiveLayout(defaultLayout);\r\n      // }\r\n      actions.setExternalLayouts(layouts);\r\n      actions.setBufferLayout(layouts[0].layout);\r\n    }\r\n  ),\r\n  onToggleViewModeListener: thunkOn(\r\n    // targetResolver:\r\n    (actions, storeActions) => storeActions.appModel.toggleViewMode,\r\n    // handler:\r\n    (actions, target, { getState, getStoreState }) => {\r\n      console.log(\r\n        \"listened to on toggle view mode in layout model, setting layout from buffer\"\r\n      );\r\n      const { activeLayout } = getState();\r\n      const buf = getState().bufferLayout;\r\n      if (getStoreState().appModel.appMode === AppMode.DISPLAY) {\r\n        console.log(\"IT WAS IN DISPLAY MODE\");\r\n        if (activeLayout?.layout) {\r\n          activeLayout.layout = buf;\r\n          actions.setActiveLayout(activeLayout);\r\n        }\r\n      }\r\n    }\r\n  ),\r\n  //simple setters\r\n  setActiveLayout: action((state, newActiveLayout) => {\r\n    // console.log(\"setting active layout\");\r\n    // console.log(newActiveLayout);\r\n    state.activeLayout = newActiveLayout;\r\n  }),\r\n  setExternalLayouts: action((state, newLayoutArray) => {\r\n    console.log(\"setting external layouts\");\r\n    state.externalLayouts = newLayoutArray;\r\n  }),\r\n  //mutators\r\n  swapCardContent: thunk(\r\n    (actions, swapInfo, { getState, getStoreState, getStoreActions }) => {\r\n      const currentModel = getStoreState() as StoreModel;\r\n      // const activeCards = curModel.appModel.activeCards;\r\n      const { activeLayout } = getState();\r\n      if (activeLayout) {\r\n        const buf = getState().bufferLayout;\r\n        activeLayout.layout = buf;\r\n        activeLayout.swapCard(swapInfo);\r\n        actions.setActiveLayout(activeLayout);\r\n        // actions.setBufferLayout(activeLayout.layout);\r\n      }\r\n    }\r\n  ),\r\n  deleteCard: thunk(\r\n    (actions, cardToDelete, { getState, getStoreState, getStoreActions }) => {\r\n      console.log(\"deleting card at layotus model\");\r\n      console.log(cardToDelete);\r\n      // let buf = getState().bufferLayout;\r\n      const previousLayout = getState().activeLayout;\r\n      console.log(\"got here\");\r\n      const { activeLayout } = getState();\r\n      if (activeLayout) {\r\n        const buf = getState().bufferLayout;\r\n        activeLayout.layout = buf;\r\n        activeLayout.removeCard(cardToDelete);\r\n        actions.setActiveLayout(activeLayout);\r\n      }\r\n    }\r\n  ),\r\n  addCard: thunk((actions, cardAddEvent, { getState, getStoreState }) => {\r\n    console.log(\"adding card\");\r\n    console.log(cardAddEvent);\r\n    const { availableCards } = getStoreState().appModel;\r\n    const { sourceId, targetPosition } = cardAddEvent;\r\n    const cardToAdd = availableCards.find((c) => c.sourceId == sourceId);\r\n    const { activeLayout } = getState();\r\n    if (activeLayout && cardToAdd) {\r\n      const buf = getState().bufferLayout;\r\n      console.log(debug(buf));\r\n      activeLayout.setGridLayout(buf);\r\n      activeLayout?.addCard(cardToAdd, targetPosition);\r\n      actions.setActiveLayout(activeLayout);\r\n      // actions.setBufferLayout(activeLayout.layout);\r\n      console.log(cardToAdd);\r\n    }\r\n  }),\r\n  registerCardLoadFailure: thunk((actions, failedCard, { getState, getStoreState }) => {\r\n    console.log(\"Got card Register Load Failure at Layouts Model\");\r\n    console.log(failedCard);\r\n    const { activeLayout } = getState();\r\n    if (activeLayout){\r\n      activeLayout.failCard(failedCard)\r\n    }\r\n    // if (activeLayout && cardToAdd) {\r\n    //   const buf = getState().bufferLayout;\r\n    //   console.log(debug(buf));\r\n    //   activeLayout.setGridLayout(buf);\r\n    //   activeLayout?.addCard(cardToAdd, targetPosition);\r\n    //   actions.setActiveLayout(activeLayout);\r\n    //   // actions.setBufferLayout(activeLayout.layout);\r\n    //   console.log(cardToAdd);\r\n    // }\r\n  }),\r\n  setBufferLayout: action((state, layouts) => {\r\n    console.log(\"setting buffer layout\");\r\n    console.log(layouts);\r\n    state.bufferLayout = layouts;\r\n    // state.tempLayout = layouts;\r\n  }),\r\n  setTempLayout: action((state, layouts) => {\r\n    console.log(\"setting buffer layout\");\r\n    console.log(layouts);\r\n    state.tempLayout = layouts;\r\n  }),\r\n  updateLayout: action((state, swap) => {\r\n    const old = state.activeLayout;\r\n    if (old) {\r\n      old.swapCard(swap);\r\n      console.log(old.layout);\r\n      state.activeLayout = old;\r\n    }\r\n  }),\r\n};\r\n\r\nexport default layoutsModel;\r\n","import { action, Action, ActionOn, actionOn, thunkOn, ThunkOn, thunk, Thunk } from \"easy-peasy\";\r\nimport { StoreModel } from \"./index\";\r\n\r\nexport interface LogModel{\r\n  //state\r\n  data: string[]\r\n\r\n  //requests\r\n    // onUpdate: ThunkOn<LogModel, never, StoreModel>\r\n  //setter\r\n  setData: Action<LogModel, string[]>\r\n\r\n}\r\n\r\nconst logModel: LogModel= {\r\n    //state\r\n    data: [],\r\n    \r\n    //requests\r\n\r\n    //setters\r\n    setData: action((state, data) => {\r\n    state.data = data\r\n    }),\r\n    //listeners\r\n    // onUpdate: thunkOn(\r\n    //     (actions, storeActions) =>\r\n    //         [\r\n\t// \t\t storeActions.samplesModel.loadSamples,\r\n\t// \t\t storeActions.samplesModel.setSamples\r\n    //         ],\r\n    //     (actions, target) => {\r\n\r\n\r\n    //     }\r\n    //   ),\r\n};\r\n\r\nexport default logModel;\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n// let log = {\r\n// \tinfo: function info(message) {\r\n// \t\tconst callerInfo = getFileName(info.caller.name);\r\n// \t\tconsole.log(\r\n// \t\t\tnew Date() +\r\n// \t\t\t\t' ' +\r\n// \t\t\t\targuments.callee.name.toUpperCase() +\r\n// \t\t\t\t' ' +\r\n// \t\t\t\tcallerInfo.filename +\r\n// \t\t\t\t':' +\r\n// \t\t\t\tcallerInfo.line +\r\n// \t\t\t\t':' +\r\n// \t\t\t\tcallerInfo.column +\r\n// \t\t\t\t' ' +\r\n// \t\t\t\tinfo.caller.name +\r\n// \t\t\t\t'() ' +\r\n// \t\t\t\tmessage\r\n// \t\t);\r\n// \t},\r\n// };\r\n\r\n// function getFileName(caller) {\r\n//   const STACK_FUNC_NAME = new RegExp(/at\\s+((\\S+)\\s)?\\((\\S+):(\\d+):(\\d+)\\)/);\r\n// \tlet err = new Error();\r\n// \tError.captureStackTrace(err);\r\n// \tlet stacks = err.stack.split('\\n').slice(1);\r\n\r\n// \tlet callerInfo = null;\r\n// \tfor (let i = 0; i < stacks.length; i++) {\r\n// \t\tcallerInfo = STACK_FUNC_NAME.exec(stacks[i]);\r\n    \r\n// \t\tif (callerInfo[2] === caller) {\r\n// \t\t\treturn {\r\n// \t\t\t\tfilename: callerInfo[3],\r\n// \t\t\t\tline: callerInfo[4],\r\n// \t\t\t\tcolumn: callerInfo[5],\r\n// \t\t\t};\r\n// \t\t}\r\n// \t}\r\n\r\n// \treturn null;\r\n// }\r\n\r\n// function iWantToLog() {\r\n// \tlog.info('Testing my log');\r\n// }\r\n\r\n// iWantToLog();","import { PackNode } from \"@components/SampleTray/NewSampleTray/Packer\";\r\nimport RawSampleRow from \"@interfaces/RawSampleRow\";\r\nimport { mapRange } from \"@utils\";\r\nimport Konva from \"konva\";\r\n\r\nclass SampleData {\r\n  id!: string;\r\n  src!: string;\r\n  tags!: string[];\r\n  svgPath!: string;\r\n  filename!: string;\r\n  length!: number;\r\n  composition: string;\r\n  startTime: Date;\r\n  endTime: Date;\r\n  w: number;\r\n  h: number;\r\n  konvaObject: Konva.Path | undefined;\r\n  // node: PackNode | undefined;\r\n  fit: PackNode | undefined;\r\n\r\n  constructor(sampleDataRow: RawSampleRow) {\r\n    const {\r\n      filename,\r\n      tags,\r\n      composition,\r\n      starTime: start,\r\n      endTime: end,\r\n      hour,\r\n      svgPath,\r\n      length,\r\n    } = sampleDataRow;\r\n\r\n    const url = `${process.env.PUBLIC_URL}/Clips/` + filename;\r\n    const defaultStartTime = new Date(\"1995-12-17T03:24:00\");\r\n    const defaultEndTime = new Date(\"1995-12-17T03:24:01\");\r\n    this.id = filename;\r\n    this.src = url;\r\n    this.tags = tags.split(\",\");\r\n    this.startTime = defaultStartTime;\r\n    this.endTime = defaultEndTime;\r\n    this.composition = composition;\r\n    this.filename = filename;\r\n    this.svgPath = svgPath;\r\n    this.length = length;\r\n    this.konvaObject = undefined;\r\n    this.w = undefined;\r\n    this.h = undefined;\r\n    // this.node = undefined;\r\n    this.fit = undefined;\r\n  }\r\n\r\n  setPath = (path: string): void => {\r\n    this.svgPath = path;\r\n  };\r\n  calculateDimensions(containerWidth: number, rowHeight: number): void {\r\n    const margin = 0;\r\n    this.w = mapRange(this.length, 0, 6.5, 0 + margin, containerWidth - margin);\r\n    this.h = rowHeight;\r\n  }\r\n  // createKonvaObject() {\r\n  //   this.konvaObject = new Konva.Path({\r\n  //     x: this.fit.x,\r\n  //     y: this.fit.y,\r\n  //     data: this.svgPath,\r\n  //     fill: \"green\",\r\n  //     scale: {\r\n  //       x: 2,\r\n  //       y: 2,\r\n  //     },\r\n  //   });\r\n  // }\r\n}\r\nexport default SampleData;\r\n","import SampleData from \"@classes/SampleData\"\nimport RawSampleRow from \"@interfaces/RawSampleRow\";\nimport {randomElements} from \"@utils\"\nimport tags from \"./tags\";\n\nconst placeHolderSamplePaths = [\"DNB_BREAK_134-1.wav\", \"Samples/s1.wav\"]\nconst recitalrecordings = [\"RECORDINGS/Bach Move 2 v2.wav\", \"RECORDINGS/Bach Move 3 v2.wav\"]\n\n\nconst makeDefaultSamples = (count: number): SampleData[] =>{\n    const defaultSamples: SampleData[] = [];\n    // const defaultUrl = `${process.env.PUBLIC_URL}/Samples/s1.wav`\n    // const defaultUrl = `${process.env.PUBLIC_URL}/DNB_BREAK_134-1.wav`\n    const defaultStartTime = new Date(\"1995-12-17T03:24:00\")\n    const defaultEndTime = new Date(\"1995-12-17T03:24:01\")\n\n\n    for (let i = 0; i < count; i++) {\n        const sampleUrl = `${process.env.PUBLIC_URL}/`+randomElements(placeHolderSamplePaths, 1)[0]\n        const basicRow: RawSampleRow = {\n            composition:`placeHolderSample_${i}`,\n            starTime: \"1995-12-17T03:24:00\",\n            endTime: \"1995-12-17T03:24:01\",\n            tags: \"MR, FD\",\n            date: \"2021-09-24\",\n            hour: \"222332\",\n            svgPath: \"\",\n            length: 1.0,\n            filename: sampleUrl\n        }\n        const tagNames = randomElements(tags, 3)\n\n        const sampleD = new SampleData(basicRow)\n        defaultSamples.push(sampleD)\n    }\n    return defaultSamples\n}\n\nconst placeHolderSamples = makeDefaultSamples(30)\n\nexport default placeHolderSamples","import { action, Action, thunk, Thunk, thunkOn, ThunkOn } from \"easy-peasy\";\nimport History from \"@classes/History\";\nimport { Layouts } from \"react-grid-layout\";\nimport WaveFormBuilder from \"@classes/WaveFormBuilder\";\nimport SampleData from \"@classes/SampleData\";\nimport placeHolderSamples from \"@static/placeHolderSamples\";\nimport { StoreModel } from \"model\";\nimport WaveformData from \"waveform-data\";\nimport { actions } from \"react-table\";\nimport RawSampleRow from \"@interfaces/RawSampleRow\";\nimport Papa from \"papaparse\";\nimport { downloadBlob } from \"@utils\";\nimport analyzeClips from \"@static/analyzeClips\";\nexport interface SamplesModel {\n  //state\n  samples: SampleData[];\n  draggingSample: string;\n  //listeners\n\n  //thunks\n\n  //simple setters\n  setSamples: Action<SamplesModel, SampleData[]>;\n  setDraggingSample: Action<SamplesModel, string>;\n\n  onSetSamplesSheets: ThunkOn<SamplesModel, never, StoreModel>;\n  //proccessing\n  processSamples: Thunk<SamplesModel, never, StoreModel>;\n  loadSamples: Thunk<SamplesModel>;\n}\n\nconst samplesModel: SamplesModel = {\n  //state\n  samples: placeHolderSamples,\n  draggingSample: placeHolderSamples[0].id,\n  //listeners\n  onSetSamplesSheets: thunkOn(\n    (actions, storeActions) => storeActions.googleSheetsModel.setSamplesSheet,\n    (actions, target) => {\n      console.log(target.payload);\n      const rawSampleRows = target.payload as RawSampleRow[];\n      if (analyzeClips) {\n        processSamples(rawSampleRows).then((samples) => {\n          actions.setSamples(samples);\n          const csv = Papa.unparse(samples);\n          downloadBlob(csv, \"test.csv\", \"text/csv;charset=utf-8;\");\n        });\n      } else {\n        const sampleDataArray = rawSampleRows.map((r) => new SampleData(r));\n        actions.setSamples(sampleDataArray);\n      }\n    }\n  ),\n  //processing\n  processSamples: thunk((actions, _, { getState }) => {\n    console.log(\"processing samples\");\n    const state = getState();\n    const { samples } = { ...state };\n    console.log(samples);\n    const processor = new WaveFormBuilder();\n    const processedSamples = samples.map((s) => processor.generateSVG(s));\n    Promise.allSettled(processedSamples).then((results) => {\n      const succesfulAnalaysisSamples: SampleData[] = [];\n      for (const result of results) {\n        if (result.status === \"fulfilled\") {\n          succesfulAnalaysisSamples.push(result.value);\n        }\n      }\n      actions.setSamples(succesfulAnalaysisSamples);\n    });\n    console.log(processedSamples);\n  }),\n  loadSamples: thunk((actions) => {\n    console.log(\"processing samples\");\n  }),\n  setSamples: action((state, samplesArray) => {\n    console.log(\"setting samples\");\n    state.samples = samplesArray;\n  }),\n  setDraggingSample: action((state, id) => {\n    console.log(\"setting samples\");\n    state.draggingSample = id;\n  }),\n};\n\nexport default samplesModel;\n\nconst processSamples = (\n  sampleRows: RawSampleRow[],\n  max?: number\n): Promise<SampleData[]> => {\n  if (max) {\n    sampleRows = sampleRows.filter((r) => r.tags !== undefined).slice(max);\n  } else {\n    sampleRows = sampleRows.filter((r) => r.tags !== undefined);\n  }\n  const sampleDataArray = sampleRows.map((s) => new SampleData(s));\n  const processor = new WaveFormBuilder();\n  const processedSamples = sampleDataArray.map((s) => processor.generateSVG(s));\n  return Promise.allSettled(processedSamples).then((results) => {\n    const succesfulAnalaysisSamples: SampleData[] = [];\n    for (const result of results) {\n      if (result.status === \"fulfilled\") {\n        succesfulAnalaysisSamples.push(result.value);\n      }\n    }\n    return succesfulAnalaysisSamples;\n  });\n};\n","import appData, { AppDataModel } from \"./appModel\";\r\nimport compositonsModel, {CompositionsModel} from \"./ðŸŽ»compositionsModel\";\r\nimport googleSheetsModel, { GoogleSheetsModel } from \"./googleSheetsModel\";\r\nimport historyData, { HistoryModel } from \"./historyModel\";\r\nimport layoutsModel, { LayoutsModel } from \"./layoutsModel\";\r\nimport logModel, {LogModel} from \"./logModel\";\r\nimport samplesModel, { SamplesModel } from \"./samplesModel\";\r\n\r\n// https://codesandbox.io/s/easy-peasy-typescript-v3-riqbl?file=/src/model/todos.ts\r\n\r\nexport interface StoreModel {\r\n  appModel: AppDataModel;\r\n  historyModel: HistoryModel;\r\n  layoutsModel: LayoutsModel;\r\n  googleSheetsModel: GoogleSheetsModel;\r\n  samplesModel: SamplesModel; \r\n  compositionsModel: CompositionsModel;\r\n  logModel: LogModel;\r\n}\r\n\r\nconst model: StoreModel = {\r\n  appModel: appData,\r\n  historyModel: historyData,\r\n  layoutsModel: layoutsModel,\r\n  googleSheetsModel: googleSheetsModel,\r\n  samplesModel: samplesModel,\r\n  compositionsModel: compositonsModel,\r\n  logModel: logModel, \r\n};\r\n\r\nexport default model;\r\n","import { createStore, action } from 'easy-peasy';\r\nimport model from './model';\r\nimport logger from 'redux-logger'\r\n// const store = createStore(model);\r\n\r\nconst store = createStore(model, {\r\n    devTools: process.env.NODE_ENV === 'development',\r\n    middleware: [\r\n      logger\r\n    ]\r\n    // initialState: { commentsModel: { comments }, postsModel: { posts } },\r\n});\r\n  \r\nif (process.env.NODE_ENV === \"development\") {\r\n    if (module.hot) {\r\n      module.hot.accept(\"./model\", () => {\r\n        store.reconfigure(model);  // ðŸ‘ˆ Here is the magic\r\n      });\r\n    }\r\n}\r\n  \r\nexport default store;\r\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport reportWebVitals from './reportWebVitals';\nimport { StoreProvider } from \"easy-peasy\";\nimport store from \"./store\";\n\nReactDOM.render(\n  <StoreProvider store={store}>\n    <App />\n  </StoreProvider>,\n  document.getElementById('root')\n);\n\n// If you want to start measuring performance in your app, pass a function\n// to log results (for example: reportWebVitals(console.log))\n// or send to an analytics endpoint. Learn more: https://bit.ly/CRA-vitals\nreportWebVitals();\n"],"sourceRoot":""}